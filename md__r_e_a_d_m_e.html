<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <base href="/quant-pricer-cpp/">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>quant-pricer-cpp: quant-pricer-cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">quant-pricer-cpp
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__r_e_a_d_m_e.html','',''); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">quant-pricer-cpp </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p><b>Modern C++20 option-pricing library with Blackâ€“Scholes analytics, Monte Carlo (variance reduction, pathwise/LR Greeks, QMC), and PDE (Crankâ€“Nicolson)â€”with tests, benchmarks, clang-tidy, sanitizers, and CI.</b> <a href="https://mateobodon.github.io/quant-pricer-cpp/">API Docs</a></p>
<p><a href="https://github.com/MateoBodon/quant-pricer-cpp/actions/workflows/ci.yml"><img src="https://github.com/mateobodon/quant-pricer-cpp/actions/workflows/ci.yml/badge.svg" alt="CI" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/MateoBodon/quant-pricer-cpp/actions/workflows/ci.yml"><img src="https://github.com/MateoBodon/quant-pricer-cpp/actions/workflows/ci.yml/badge.svg?job=sanitizers&amp;label=ASan%2FUBSan" alt="Sanitizers" style="pointer-events: none;" class="inline"/></a> <a href="https://app.codecov.io/gh/MateoBodon/quant-pricer-cpp"><img src="https://codecov.io/gh/MateoBodon/quant-pricer-cpp/branch/master/graph/badge.svg" alt="Coverage" style="pointer-events: none;" class="inline"/></a> <a href="https://mateobodon.github.io/quant-pricer-cpp/coverage/"><img src="https://img.shields.io/badge/coverage-HTML-blue" alt="Coverage HTML" class="inline"/></a> <a href="https://mateobodon.github.io/quant-pricer-cpp/"><img src="https://github.com/MateoBodon/quant-pricer-cpp/actions/workflows/docs-pages.yml/badge.svg?branch=master&amp;label=Docs%20Pages" alt="Docs" style="pointer-events: none;" class="inline"/></a></p>
<p><a href="https://github.com/MateoBodon/quant-pricer-cpp/releases"><img src="https://img.shields.io/github/v/release/MateoBodon/quant-pricer-cpp?display_name=tag" alt="Release" class="inline"/></a> [<img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT" style="pointer-events: none;" class="inline"/>](LICENSE) <a href="docs/artifacts/manifest.json"><img src="https://img.shields.io/badge/reproducibility-manifest-blue" alt="Reproducibility" class="inline"/></a></p>
<p><b>TL;DR:</b> A fast, tested C++ pricer that cross-checks three independent methods (analytic / MC / PDE), exposes Greeks via pathwise &amp; likelihood-ratio estimators, and ships with benchmarks and convergence reports so results are both correct and reproducible.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Install &amp; Quickstart</h1>
<div class="fragment"><div class="line">pip install pyquant-pricer</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">import</span> pyquant_pricer <span class="keyword">as</span> qp</div>
<div class="line"> </div>
<div class="line">spot, strike, rate, div, vol, tenor = 100.0, 105.0, 0.02, 0.01, 0.25, 0.5</div>
<div class="line">call_price = qp.bs_call(spot, strike, rate, div, vol, tenor)</div>
<div class="line">delta = qp.bs_delta_call(spot, strike, rate, div, vol, tenor)</div>
<div class="line">gamma = qp.bs_gamma(spot, strike, rate, div, vol, tenor)</div>
<div class="line">barrier = qp.BarrierSpec(); barrier.type = qp.BarrierType.DownOut; barrier.B = 95.0</div>
<div class="line">barrier_price = qp.barrier_bs(qp.OptionType.Call, barrier, spot, strike, rate, div, vol, 1.0)</div>
<div class="line">params = qp.McParams(); params.spot = spot; params.strike = strike; params.rate = rate; params.vol = vol</div>
<div class="line">params.num_paths = 20000; params.time = tenor; params.seed = 7</div>
<div class="line">mc_price = qp.mc_european_call(params).estimate.value</div>
<div class="line">print(f<span class="stringliteral">&quot;Call: {call_price:.4f}, Delta: {delta:.4f}, Barrier: {barrier_price:.4f}&quot;</span>)</div>
<div class="line">print(f<span class="stringliteral">&quot;Gamma: {gamma:.4f}, MC price: {mc_price:.4f}&quot;</span>)</div>
</div><!-- fragment --><p>See <a href="python/examples/quickstart.py"><span class="tt">python/examples/quickstart.py</span></a> for a fuller walkthrough that optionally runs a FAST Heston calibration when sample data is available.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Results at a Glance</h1>
<p>Curated figures (plus precise reproduction commands) live on the <a href="https://mateobodon.github.io/quant-pricer-cpp/Results.html">Results page</a>.</p>
<ul>
<li><a href="https://mateobodon.github.io/quant-pricer-cpp/Results.html#tri-engine-agreement"><img src="docs/artifacts/tri_engine_agreement.png" alt="Tri-engine agreement" width="230" class="inline"/></a><br  />
 <b>Tri-Engine Agreement (BS / MC / PDE)</b> â€“ Analytic, deterministic MC, and Crankâ€“Nicolson agree to &lt;5 bps across strikes; MC CI is shown.<br  />
 Reproduce: <span class="tt">python scripts/tri_engine_agreement.py --quant-cli build/quant_cli --output docs/artifacts/tri_engine_agreement.png --csv docs/artifacts/tri_engine_agreement.csv</span> <br  />
 Data: <a href="https://mateobodon.github.io/quant-pricer-cpp/artifacts/tri_engine_agreement.csv">tri_engine_agreement.csv</a></li>
<li><a href="https://mateobodon.github.io/quant-pricer-cpp/Results.html#qmc-vs-prng-equal-wall-clock"><img src="docs/artifacts/qmc_vs_prng_equal_time.png" alt="QMC vs PRNG equal-time RMSE" width="230" class="inline"/></a><br  />
 <b>QMC vs PRNG (equal wall-clock)</b> â€“ Sobol + Brownian bridge delivers â‰ˆ1.4Ã— lower RMSE than PRNG at matched runtime for European + Asian calls.<br  />
 Reproduce: <span class="tt">python scripts/qmc_vs_prng_equal_time.py --output docs/artifacts/qmc_vs_prng_equal_time.png --csv docs/artifacts/qmc_vs_prng_equal_time.csv --fast</span> <br  />
 Data: <a href="https://mateobodon.github.io/quant-pricer-cpp/artifacts/qmc_vs_prng_equal_time.csv">qmc_vs_prng_equal_time.csv</a></li>
<li><a href="https://mateobodon.github.io/quant-pricer-cpp/Results.html#wrds-heston"><img src="docs/artifacts/wrds/heston_wrds_summary.png" alt="WRDS Heston summary" width="230" class="inline"/></a><br  />
 <b>WRDS Heston (multi-date Vega + Î”-hedge)</b> â€“ Aggregated over â‰¥5 calm/stress dates with vega-weighted IV RMSE, quotes-weighted OOS MAE, and Î”-hedged 1d buckets.<br  />
 Reproduce (sample): <span class="tt">python wrds_pipeline/pipeline.py --dateset wrds_pipeline/dateset.yaml --use-sample</span> <br  />
 Data: <a href="https://mateobodon.github.io/quant-pricer-cpp/artifacts/wrds_agg_pricing.csv">wrds_agg_pricing.csv</a>, <a href="https://mateobodon.github.io/quant-pricer-cpp/artifacts/wrds_agg_oos.csv">wrds_agg_oos.csv</a>, <a href="https://mateobodon.github.io/quant-pricer-cpp/artifacts/wrds_agg_pnl.csv">wrds_agg_pnl.csv</a></li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Table of Contents</h1>
<ul>
<li>Features</li>
<li>Architecture</li>
<li>Numerical Methods</li>
<li>Variance Reduction &amp; Greeks</li>
<li>Determinism &amp; Reproducibility</li>
<li>Build &amp; Install</li>
<li>CLI Usage</li>
<li>Library API Overview</li>
<li>Validation &amp; Results</li>
<li>Benchmarks</li>
<li>Testing &amp; CI</li>
<li><a class="el" href="dir_49e56c817e5e54854c35e136979f97ca.html">Docs</a></li>
<li>Limitations</li>
<li>Roadmap</li>
<li>License</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Features</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
ğŸš€ <b>Core Pricing Engines</b></h2>
<ul>
<li><b>Blackâ€“Scholes Analytics</b>: Complete European option pricing with all major Greeks (Delta, Gamma, Vega, Theta, Rho)</li>
<li><b>Monte Carlo Engine</b>: High-performance GBM simulation with deterministic counter-based RNG (thread-invariant), optional PCG/MT streams, and OpenMP parallelization</li>
<li><b>PDE Solver</b>: Crankâ€“Nicolson with Rannacher start-up, optional tanh-stretched grids around the strike, and direct Î”/Î“/Î˜ extraction</li>
<li><b>Barrier Options</b>: Continuous single-barrier (up/down, in/out) pricing via Reinerâ€“Rubinstein closed-form, Brownian-bridge Monte Carlo, and absorbing-boundary PDE</li>
<li><b>American Options</b>: PSOR (finite-difference LCP) and Longstaffâ€“Schwartz Monte Carlo with polynomial basis; see <span class="tt">artifacts/american_convergence.png</span> for agreement and grid/path convergence.</li>
<li><b>Exotics</b>: Arithmetic Asian MC with geometric CV, lookback MC (fixed/floating), digitals (analytic and MC hooks)</li>
<li><b>Heston</b>: Analytic European call via characteristic-function Gaussâ€“Laguerre <b>plus Andersen QE Monte Carlo</b> with deterministic counter-based RNG for variance paths</li>
<li><b>Risk</b>: VaR/CVaR via MC and historical backtesting with Kupiec test<ul>
<li><b>Multiâ€‘Asset &amp; Jumps</b>: Basket MC with Cholesky correlation; Merton jumpâ€‘diffusion MC for European options</li>
</ul>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
âš¡ <b>Advanced Monte Carlo</b></h2>
<ul>
<li><b>Variance Reduction</b>: Antithetic variates and control variates for improved convergence</li>
<li><b>Quasi-Monte Carlo</b>: <b>Sobol</b> (optional Owen/digital shift) <b>+ Brownian bridge</b> path construction; antithetic and control variates. <em>Legacy:</em> an earlier version used a Van der Corput scalar sequence with inverse-normal transform for single-step paths.</li>
<li><b>MC Greeks</b>: Pathwise estimators (Delta, Vega) and Likelihood Ratio Method (Gamma)</li>
<li><b>Streaming Architecture</b>: Cache-friendly memory access patterns for optimal performance</li>
<li><b>Piecewise-Constant Schedules</b>: Optional rate/dividend/vol term structures for vanilla and barrier engines via CSV or <span class="tt">PiecewiseConstant</span></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
ğŸ¯ <b>Production-Ready Quality</b></h2>
<ul>
<li><b>Cross-Validation</b>: Three independent pricing methods for result verification</li>
<li><b>Comprehensive Testing</b>: Unit tests, edge cases, put-call parity, and convergence validation</li>
<li><b>Performance Benchmarks</b>: Google Benchmark integration with detailed timing analysis</li>
<li><b>Modern C++20</b>: Clean, type-safe API with constexpr optimizations</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
ğŸ”§ <b>Developer Experience</b></h2>
<ul>
<li><b>CLI Interface</b>: Command-line tool for interactive pricing and parameter exploration</li>
<li><b>CMake Build System</b>: Cross-platform support with optional dependencies</li>
<li><b>CI/CD Pipeline</b>: Multi-compiler, multi-OS testing with sanitizers and static analysis</li>
<li><b>Documentation</b>: Doxygen-generated API docs with mathematical formulations</li>
<li><b>Python Bindings</b>: Optional <span class="tt">pyquant_pricer</span> module (pybind11) with BS/MC/PDE/Heston coverage (characteristic fn + implied vol helpers), enums (<span class="tt"><a class="el" href="american_8cpp.html#ac5c3ed56e7e0c04487a55095e021afeb">OptionType</a></span>, <span class="tt">BarrierType</span>, <span class="tt">McSampler</span>, <span class="tt">McBridge</span>), and <span class="tt">PiecewiseConstant</span> schedules; wheels via cibuildwheel</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Architecture</h1>
<p>The library follows a modular design with three independent pricing engines that can cross-validate results:</p>
<div class="fragment"><div class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">â”‚ Blackâ€“Scholes   â”‚    â”‚   Monte Carlo    â”‚    â”‚   PDE Solver    â”‚</div>
<div class="line">â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚</div>
<div class="line">â”‚ â€¢ Analytic      â”‚    â”‚ â€¢ GBM Paths      â”‚    â”‚ â€¢ Crankâ€“Nicolsonâ”‚</div>
<div class="line">â”‚ â€¢ All Greeks    â”‚    â”‚ â€¢ Variance Red.  â”‚    â”‚ â€¢ Thomas Algo   â”‚</div>
<div class="line">â”‚ â€¢ Edge Cases    â”‚    â”‚ â€¢ QMC Support    â”‚    â”‚ â€¢ Log-space     â”‚</div>
<div class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">         â”‚                       â”‚                       â”‚</div>
<div class="line">         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">                                 â–¼</div>
<div class="line">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">                    â”‚   Cross-Validation  â”‚</div>
<div class="line">                    â”‚                     â”‚</div>
<div class="line">                    â”‚ â€¢ Result Comparison â”‚</div>
<div class="line">                    â”‚ â€¢ Error Analysis    â”‚</div>
<div class="line">                    â”‚ â€¢ Convergence Tests â”‚</div>
<div class="line">                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Engine Comparison</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method  </th><th class="markdownTableHeadNone">Speed  </th><th class="markdownTableHeadNone">Accuracy  </th><th class="markdownTableHeadNone">Greeks  </th><th class="markdownTableHeadNone">Complexity  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Blackâ€“Scholes</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">Low  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Monte Carlo</b>  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">Medium  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>PDE</b>  </td><td class="markdownTableBodyNone">âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡  </td><td class="markdownTableBodyNone">High  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
Numerical Methods</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
Blackâ€“Scholes Analytics</h2>
<p>Complete implementation of the Blackâ€“Scholes model with robust numerical stability:</p>
<div class="fragment"><div class="line"><span class="comment">// Price European call option</span></div>
<div class="line"><span class="keywordtype">double</span> price = <a class="code hl_function" href="namespacequant_1_1bs.html#acc9f587fb3ed3d7184ffda96a3fa5f57">quant::bs::call_price</a>(S, K, r, q, sigma, T);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// All major Greeks</span></div>
<div class="line"><span class="keywordtype">double</span> delta = <a class="code hl_function" href="namespacequant_1_1bs.html#af383ac3055e6844548cc05236a5b827c">quant::bs::delta_call</a>(S, K, r, q, sigma, T);</div>
<div class="line"><span class="keywordtype">double</span> gamma = <a class="code hl_function" href="namespacequant_1_1bs.html#a6fe4a94909b796d278623004a73f7ac1">quant::bs::gamma</a>(S, K, r, q, sigma, T);</div>
<div class="line"><span class="keywordtype">double</span> vega  = <a class="code hl_function" href="namespacequant_1_1bs.html#a440d4850067e734dbc14d96ac291e928">quant::bs::vega</a>(S, K, r, q, sigma, T);</div>
<div class="line"><span class="keywordtype">double</span> theta = <a class="code hl_function" href="namespacequant_1_1bs.html#a2c90ce2ed9f48be955e754ecf608e7dc">quant::bs::theta_call</a>(S, K, r, q, sigma, T);</div>
<div class="line"><span class="keywordtype">double</span> rho   = <a class="code hl_function" href="namespacequant_1_1bs.html#a4a5da0da63b00eee7408e218803b289d">quant::bs::rho_call</a>(S, K, r, q, sigma, T);</div>
<div class="ttc" id="anamespacequant_1_1bs_html_a2c90ce2ed9f48be955e754ecf608e7dc"><div class="ttname"><a href="namespacequant_1_1bs.html#a2c90ce2ed9f48be955e754ecf608e7dc">quant::bs::theta_call</a></div><div class="ttdeci">double theta_call(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:71</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a440d4850067e734dbc14d96ac291e928"><div class="ttname"><a href="namespacequant_1_1bs.html#a440d4850067e734dbc14d96ac291e928">quant::bs::vega</a></div><div class="ttdeci">double vega(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:63</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a4a5da0da63b00eee7408e218803b289d"><div class="ttname"><a href="namespacequant_1_1bs.html#a4a5da0da63b00eee7408e218803b289d">quant::bs::rho_call</a></div><div class="ttdeci">double rho_call(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:117</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a6fe4a94909b796d278623004a73f7ac1"><div class="ttname"><a href="namespacequant_1_1bs.html#a6fe4a94909b796d278623004a73f7ac1">quant::bs::gamma</a></div><div class="ttdeci">double gamma(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:55</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_acc9f587fb3ed3d7184ffda96a3fa5f57"><div class="ttname"><a href="namespacequant_1_1bs.html#acc9f587fb3ed3d7184ffda96a3fa5f57">quant::bs::call_price</a></div><div class="ttdeci">double call_price(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdoc">Price a European call option under Blackâ€“Scholes (present value).</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:6</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_af383ac3055e6844548cc05236a5b827c"><div class="ttname"><a href="namespacequant_1_1bs.html#af383ac3055e6844548cc05236a5b827c">quant::bs::delta_call</a></div><div class="ttdeci">double delta_call(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:39</div></div>
</div><!-- fragment --><p><b>Key Features:</b></p><ul>
<li><b>Tail-stable CDF</b>: Uses <span class="tt">erfc</span> for numerical stability in extreme cases</li>
<li><b>Edge Case Handling</b>: Zero volatility, zero time, and put-call parity validation</li>
<li><b>Constexpr Optimizations</b>: Compile-time constants for performance-critical calculations</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
Monte Carlo Engine</h2>
<p>High-performance GBM simulation with advanced variance reduction:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structquant_1_1mc_1_1_mc_params.html">quant::mc::McParams</a> params{</div>
<div class="line">    .spot = 100.0, .strike = 100.0, .rate = 0.03, .dividend = 0.0,</div>
<div class="line">    .vol = 0.2, .time = 1.0, .num_paths = 1&#39;000&#39;000, .seed = 42,</div>
<div class="line">    .antithetic = <span class="keyword">true</span>, .control_variate = <span class="keyword">true</span>,</div>
<div class="line">    .qmc = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75">quant::mc::McParams::Qmc::Sobol</a>,</div>
<div class="line">    .bridge = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae">quant::mc::McParams::Bridge::BrownianBridge</a>,</div>
<div class="line">    .num_steps = 64</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = <a class="code hl_function" href="namespacequant_1_1mc.html#a359142f9f448fda8bd468a8297093efc">quant::mc::price_european_call</a>(params);</div>
<div class="line"><span class="comment">// result.estimate.value, result.estimate.std_error, result.estimate.ci_low/ci_high</span></div>
<div class="ttc" id="anamespacequant_1_1mc_html_a359142f9f448fda8bd468a8297093efc"><div class="ttname"><a href="namespacequant_1_1mc.html#a359142f9f448fda8bd468a8297093efc">quant::mc::price_european_call</a></div><div class="ttdeci">McResult price_european_call(const McParams &amp;p)</div><div class="ttdef"><b>Definition</b> mc.cpp:396</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html">quant::mc::McParams</a></div><div class="ttdef"><b>Definition</b> mc.hpp:17</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae">quant::mc::McParams::Bridge::BrownianBridge</a></div><div class="ttdeci">@ BrownianBridge</div><div class="ttdef"><b>Definition</b> mc.hpp:30</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75">quant::mc::McParams::Qmc::Sobol</a></div><div class="ttdeci">@ Sobol</div><div class="ttdef"><b>Definition</b> mc.hpp:29</div></div>
</div><!-- fragment --><p><b>Advanced Features:</b></p><ul>
<li><b>Deterministic Counter RNG</b>: Hash-based counter generator keyed by <span class="tt">(seed, path, step, dim)</span> makes serial vs parallel runs bitwise-identical</li>
<li><b>PCG64 / MT Streams</b>: Optional stateful generators via <span class="tt">McParams::rng = <a class="el" href="namespacequant_1_1rng.html#ae6b725ef18c2efcc32f37a4e3854c34fae9201b734da1449417f2722032612866" title="PCG/Mersenne Twister style PRNG (per-thread stateful).">quant::rng::Mode::Mt19937</a></span></li>
<li><b>Antithetic Variates</b>: Automatic variance reduction through negative correlation</li>
<li><b>Control Variates</b>: Uses discounted terminal stock price as control</li>
<li><b>Quasi-Monte Carlo</b>: Sobol (Joeâ€“Kuo) sequences with optional Owen-style scramble</li>
<li><b>Brownian Bridge</b>: Low effective dimension mapping for multi-step paths</li>
<li><b>OpenMP Parallelization</b>: Multi-threaded path generation</li>
<li><b>Streaming Statistics</b>: Welford accumulators produce numerically stable means, SEs, and 95% confidence intervals</li>
<li><b>Mixed Î“ &amp; LR Î˜</b>: Combines pathwise and LR for markedly lower gamma variance and likelihood-ratio-based &#x2418;Î˜&#x2419; with common random numbers</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
PDE Solver</h2>
<p>Crankâ€“Nicolson finite-difference scheme with sophisticated boundary handling:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structquant_1_1pde_1_1_pde_params.html">quant::pde::PdeParams</a> params{</div>
<div class="line">    .spot = 100.0,</div>
<div class="line">    .strike = 100.0,</div>
<div class="line">    .rate = 0.03,</div>
<div class="line">    .dividend = 0.0,</div>
<div class="line">    .vol = 0.2,</div>
<div class="line">    .time = 1.0,</div>
<div class="line">    .type = quant::pde::OptionType::Call,</div>
<div class="line">    .grid = {321, 320, 4.0, 2.5}, <span class="comment">// M, N, Smax multiplier, tanh stretch</span></div>
<div class="line">    .log_space = <span class="keyword">true</span>,</div>
<div class="line">    .upper_boundary = <a class="code hl_enumvalue" href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38ab8537a769dbc90cb1762215441212152">quant::pde::PdeParams::UpperBoundary::Neumann</a>,</div>
<div class="line">    .compute_theta = <span class="keyword">true</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structquant_1_1pde_1_1_pde_result.html">quant::pde::PdeResult</a> res = <a class="code hl_function" href="namespacequant_1_1pde.html#a04f166d2e994def76cd8ff8d4fc7fa0b">quant::pde::price_crank_nicolson</a>(params);</div>
<div class="line"><span class="comment">// res.price, res.delta, res.gamma, res.theta</span></div>
<div class="ttc" id="anamespacequant_1_1pde_html_a04f166d2e994def76cd8ff8d4fc7fa0b"><div class="ttname"><a href="namespacequant_1_1pde.html#a04f166d2e994def76cd8ff8d4fc7fa0b">quant::pde::price_crank_nicolson</a></div><div class="ttdeci">PdeResult price_crank_nicolson(const PdeParams &amp;p)</div><div class="ttdef"><b>Definition</b> pde.cpp:193</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html">quant::pde::PdeParams</a></div><div class="ttdoc">PDE pricing parameters and grid configuration.</div><div class="ttdef"><b>Definition</b> pde.hpp:29</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_ae4220bab8d7f7a4e52c868d188d41f38ab8537a769dbc90cb1762215441212152"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38ab8537a769dbc90cb1762215441212152">quant::pde::PdeParams::UpperBoundary::Neumann</a></div><div class="ttdeci">@ Neumann</div><div class="ttdef"><b>Definition</b> pde.hpp:41</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_result_html"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_result.html">quant::pde::PdeResult</a></div><div class="ttdef"><b>Definition</b> pde.hpp:53</div></div>
</div><!-- fragment --><p><b>Numerical Sophistication:</b></p><ul>
<li><b>Crankâ€“Nicolson + Rannacher</b>: Two fully implicit steps damp non-smooth payoffs before second-order timestepping</li>
<li><b>Tanh/Sinh Stretching</b>: Optional clustering of nodes around the strike in S- or log-space to resolve Greeks more accurately</li>
<li><b>Direct Greeks</b>: Three-point central differences deliver Î” and Î“ at the spot with (\mathcal{O}(\Delta S^2)) truncation error; the optional backward (\Theta) uses a one-step backward difference (\mathcal{O}(\Delta t))</li>
<li><b>Flexible Boundaries</b>: Dirichlet and Neumann boundary conditions, with absorbing/reflecting enforcement for exotic payoffs</li>
<li><b>Adaptive Gridding</b>: Configurable spatial/time resolution with tri-diagonal solves via the Thomas algorithm</li>
</ul>
<p>For the Neumann choice in log-space we explicitly discretise <span class="tt">âˆ‚V/âˆ‚S(S_max, t) = e^{-q(T-t)}</span> as</p>
<div class="fragment"><div class="line">-U_{M-2} + U_{M-1} = Î”x Â· S_max Â· e^{-q (T-t)}</div>
</div><!-- fragment --><p>which is exactly what the solver enforces by setting the final row of the linear system to <span class="tt">[-1, 1]</span> with the right-hand side <span class="tt">Î”x Â· S_max Â· e^{-q (T-t)}</span>.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md21"></a>
American Options</h2>
<p>Early-exercise contracts are handled by three complementary engines:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structquant_1_1american_1_1_params.html">quant::american::Params</a> put{</div>
<div class="line">    .spot = 95.0, .strike = 100.0, .rate = 0.03, .dividend = 0.01,</div>
<div class="line">    .vol = 0.20, .time = 1.0, .type = <a class="code hl_enumvalue" href="namespacequant.html#ac5c3ed56e7e0c04487a55095e021afebad0bf1810982e9728fcf3ac444a015373">quant::OptionType::Put</a></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> tree_price = <a class="code hl_function" href="namespacequant_1_1american.html#a84325a7a5a116dab4d9cc220b5147131">quant::american::price_binomial_crr</a>(put, 512);         <span class="comment">// CRR binomial</span></div>
<div class="line"><span class="keyword">auto</span> psor = <a class="code hl_function" href="namespacequant_1_1american.html#a53be2b34e8f1a8cb0e771b6771fa75d8">quant::american::price_psor</a>({put, {201, 200, 4.0, 2.0}});      <span class="comment">// PSOR with stretching</span></div>
<div class="line"><span class="keyword">auto</span> lsmc = <a class="code hl_function" href="namespacequant_1_1american.html#a390399ba8dec3496ae26d12dc0571ac0">quant::american::price_lsmc</a>({put, 400&#39;000, 20250217ULL, 64});  <span class="comment">// Longstaffâ€“Schwartz</span></div>
<div class="ttc" id="anamespacequant_1_1american_html_a390399ba8dec3496ae26d12dc0571ac0"><div class="ttname"><a href="namespacequant_1_1american.html#a390399ba8dec3496ae26d12dc0571ac0">quant::american::price_lsmc</a></div><div class="ttdeci">LsmcResult price_lsmc(const LsmcParams &amp;params)</div><div class="ttdef"><b>Definition</b> american.cpp:446</div></div>
<div class="ttc" id="anamespacequant_1_1american_html_a53be2b34e8f1a8cb0e771b6771fa75d8"><div class="ttname"><a href="namespacequant_1_1american.html#a53be2b34e8f1a8cb0e771b6771fa75d8">quant::american::price_psor</a></div><div class="ttdeci">PsorResult price_psor(const PsorParams &amp;params)</div><div class="ttdef"><b>Definition</b> american.cpp:380</div></div>
<div class="ttc" id="anamespacequant_1_1american_html_a84325a7a5a116dab4d9cc220b5147131"><div class="ttname"><a href="namespacequant_1_1american.html#a84325a7a5a116dab4d9cc220b5147131">quant::american::price_binomial_crr</a></div><div class="ttdeci">double price_binomial_crr(const Params &amp;p, int steps)</div><div class="ttdef"><b>Definition</b> american.cpp:351</div></div>
<div class="ttc" id="anamespacequant_html_ac5c3ed56e7e0c04487a55095e021afebad0bf1810982e9728fcf3ac444a015373"><div class="ttname"><a href="namespacequant.html#ac5c3ed56e7e0c04487a55095e021afebad0bf1810982e9728fcf3ac444a015373">quant::OptionType::Put</a></div><div class="ttdeci">@ Put</div><div class="ttdef"><b>Definition</b> barrier.hpp:6</div></div>
<div class="ttc" id="astructquant_1_1american_1_1_params_html"><div class="ttname"><a href="structquant_1_1american_1_1_params.html">quant::american::Params</a></div><div class="ttdef"><b>Definition</b> american.hpp:13</div></div>
</div><!-- fragment --><p><b>Why three methods?</b></p><ul>
<li><b>Binomial CRR</b>: Reliable benchmark for coarse grids and regression targets.</li>
<li><b>PSOR</b>: Finite-difference solve with contact enforcement and Ï‰ over-relaxation (benchmarked in <span class="tt">bench_pde</span>).</li>
<li><b>LSMC</b>: Regression Monte Carlo with orthogonal polynomial basis (scaled at-the-money) and streaming SEs.</li>
</ul>
<p>The <span class="tt">american</span> CLI engine exposes all three solvers, honours <span class="tt">--json</span> output, and supports thread overrides shared with the MC engine.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md23"></a>
Variance Reduction &amp; Greeks</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md24"></a>
Monte Carlo Greeks</h2>
<p>The library implements both pathwise and likelihood-ratio estimators for comprehensive Greek calculation:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> greeks = <a class="code hl_function" href="namespacequant_1_1mc.html#a5ed0f2a042a71e0a79981184cc74ce43">quant::mc::greeks_european_call</a>(params);</div>
<div class="line"><span class="comment">// Pathwise Î”/Î½: greeks.delta.value, greeks.vega.value</span></div>
<div class="line"><span class="comment">// Î“ estimators: greeks.gamma_lrm.value (LRM), greeks.gamma_mixed.value (mixed)</span></div>
<div class="line"><span class="comment">// Î˜ (time decay): greeks.theta.value (backward difference with common RNG)</span></div>
<div class="line"><span class="comment">// Each statistic carries std_error and 95% CI bounds via ci_low/ci_high</span></div>
<div class="ttc" id="anamespacequant_1_1mc_html_a5ed0f2a042a71e0a79981184cc74ce43"><div class="ttname"><a href="namespacequant_1_1mc.html#a5ed0f2a042a71e0a79981184cc74ce43">quant::mc::greeks_european_call</a></div><div class="ttdeci">GreeksResult greeks_european_call(const McParams &amp;p)</div><div class="ttdef"><b>Definition</b> mc.cpp:502</div></div>
</div><!-- fragment --><p><b>Pathwise Estimators (Delta, Vega):</b></p><ul>
<li><b>Delta</b>: <span class="tt">âˆ‚V/âˆ‚S = e^(-rT) * 1{S_T &gt; K} * (S_T/S_0)</span></li>
<li><b>Vega</b>: <span class="tt">âˆ‚V/âˆ‚Ïƒ = e^(-rT) * 1{S_T &gt; K} * S_T * (W_T/Ïƒ - ÏƒT)</span></li>
</ul>
<p><b>Gamma Estimators:</b></p><ul>
<li><b><span class="tt">gamma_lrm</span></b>: Classic likelihood-ratio weight <span class="tt">((Z^2 - 1 - ÏƒâˆšT Z)/(S_0^2 Ïƒ^2 T))</span></li>
<li><b><span class="tt">gamma_mixed</span></b>: Pathwise Î” Ã— LR score with the analytic correction <span class="tt">-Î”/S_0</span>, lowering the variance (see table below)</li>
</ul>
<p><b>Likelihood Ratio Method (Gamma):</b> The library also provides a robust Î˜ estimator via a backward calendarâ€‘time finite difference with common random numbers, which matches PDE Î˜ in unit tests.</p><ul>
<li><b>Gamma</b>: <span class="tt">âˆ‚Â²V/âˆ‚SÂ² = e^(-rT) * 1{S_T &gt; K} * S_T * (W_TÂ² - T)/(S_0Â²ÏƒÂ²T)</span></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md25"></a>
Variance Reduction Techniques</h2>
<p><b>Counter-Based RNG (deterministic by construction):</b> </p><div class="fragment"><div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#ad20be0b0e8840b8481efbbc580dac477">rng</a> = <a class="code hl_enumvalue" href="namespacequant_1_1rng.html#ae6b725ef18c2efcc32f37a4e3854c34fa64d129224a5377b63e9727479ec987d9">quant::rng::Mode::Counter</a>; <span class="comment">// default</span></div>
<div class="line"><span class="comment">// Hash(seed, path, step, dim) â†’ uniform â†’ inverse normal</span></div>
<div class="line"><span class="comment">// Guarantees identical streams regardless of OpenMP scheduling</span></div>
<div class="ttc" id="anamespacequant_1_1rng_html_ae6b725ef18c2efcc32f37a4e3854c34fa64d129224a5377b63e9727479ec987d9"><div class="ttname"><a href="namespacequant_1_1rng.html#ae6b725ef18c2efcc32f37a4e3854c34fa64d129224a5377b63e9727479ec987d9">quant::rng::Mode::Counter</a></div><div class="ttdeci">@ Counter</div><div class="ttdoc">Counter-based, reproducible across threading schedules.</div><div class="ttdef"><b>Definition</b> rng.hpp:15</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_ad20be0b0e8840b8481efbbc580dac477"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#ad20be0b0e8840b8481efbbc580dac477">quant::mc::McParams::rng</a></div><div class="ttdeci">quant::rng::Mode rng</div><div class="ttdef"><b>Definition</b> mc.hpp:28</div></div>
</div><!-- fragment --><p><b>Antithetic Variates:</b> </p><div class="fragment"><div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#ac90a8c9a299af98d84663cce4f40db32">antithetic</a> = <span class="keyword">true</span>; <span class="comment">// Simulate W_t and -W_t in lockstep</span></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_ac90a8c9a299af98d84663cce4f40db32"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#ac90a8c9a299af98d84663cce4f40db32">quant::mc::McParams::antithetic</a></div><div class="ttdeci">bool antithetic</div><div class="ttdef"><b>Definition</b> mc.hpp:26</div></div>
</div><!-- fragment --><p><b>Control Variates:</b> </p><div class="fragment"><div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#aaf22f442a8e989bf007de4c746a60860">control_variate</a> = <span class="keyword">true</span>; <span class="comment">// Use discounted S_T as zero-variance control</span></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_aaf22f442a8e989bf007de4c746a60860"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#aaf22f442a8e989bf007de4c746a60860">quant::mc::McParams::control_variate</a></div><div class="ttdeci">bool control_variate</div><div class="ttdef"><b>Definition</b> mc.hpp:27</div></div>
</div><!-- fragment --><p><b>Sobol + Brownian Bridge:</b> </p><div class="fragment"><div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a5c80140993b18711dcb84bdfd0360553">qmc</a> = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75">quant::mc::McParams::Qmc::Sobol</a>;</div>
<div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a847477f8fc5bdda86e975f9e908e06b8">bridge</a> = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae">quant::mc::McParams::Bridge::BrownianBridge</a>;</div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a5c80140993b18711dcb84bdfd0360553"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a5c80140993b18711dcb84bdfd0360553">quant::mc::McParams::qmc</a></div><div class="ttdeci">Qmc qmc</div><div class="ttdef"><b>Definition</b> mc.hpp:31</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a847477f8fc5bdda86e975f9e908e06b8"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a847477f8fc5bdda86e975f9e908e06b8">quant::mc::McParams::bridge</a></div><div class="ttdeci">Bridge bridge</div><div class="ttdef"><b>Definition</b> mc.hpp:32</div></div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md27"></a>
Determinism &amp; Reproducibility</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md28"></a>
Seed-Based Reproducibility</h2>
<div class="fragment"><div class="line"><span class="comment">// Deterministic across threads thanks to counter-based RNG</span></div>
<div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a9214a623c57f1bf9dd0f9507b7089d84">seed</a> = 42;</div>
<div class="line">params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#ad20be0b0e8840b8481efbbc580dac477">rng</a>  = <a class="code hl_enumvalue" href="namespacequant_1_1rng.html#ae6b725ef18c2efcc32f37a4e3854c34fa64d129224a5377b63e9727479ec987d9">quant::rng::Mode::Counter</a>;</div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a9214a623c57f1bf9dd0f9507b7089d84"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a9214a623c57f1bf9dd0f9507b7089d84">quant::mc::McParams::seed</a></div><div class="ttdeci">std::uint64_t seed</div><div class="ttdef"><b>Definition</b> mc.hpp:25</div></div>
</div><!-- fragment --><ul>
<li><span class="tt">tests/test_rng_repro.cpp</span> asserts that serial vs OpenMP-parallel executions (1, 4, 8 threads) produce bitwise-identical estimates and standard errors.</li>
<li>CLI exposes <span class="tt">--rng=counter|mt19937</span> to toggle the generator while keeping reproducibility guarantees explicit.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md29"></a>
Cross-Platform Consistency</h2>
<ul>
<li><b>IEEE 754 Compliance</b>: Consistent floating-point behavior</li>
<li><b>Compiler Agnostic</b>: Tested on GCC, Clang, MSVC</li>
<li><b>OS Independence</b>: Linux, macOS, Windows support</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md30"></a>
Validation Framework</h2>
<div class="fragment"><div class="line"><span class="comment">// Three-way cross-validation</span></div>
<div class="line"><span class="keywordtype">double</span> bs_price = <a class="code hl_function" href="namespacequant_1_1bs.html#acc9f587fb3ed3d7184ffda96a3fa5f57">quant::bs::call_price</a>(S, K, r, q, sigma, T);</div>
<div class="line"><span class="keyword">auto</span> mc_result = <a class="code hl_function" href="namespacequant_1_1mc.html#a359142f9f448fda8bd468a8297093efc">quant::mc::price_european_call</a>(mc_params);</div>
<div class="line"><span class="keywordtype">double</span> pde_price = <a class="code hl_function" href="namespacequant_1_1pde.html#a04f166d2e994def76cd8ff8d4fc7fa0b">quant::pde::price_crank_nicolson</a>(pde_params);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Results should agree within numerical precision</span></div>
<div class="line">assert(std::abs(bs_price - mc_result.estimate.value) &lt; 3 * mc_result.estimate.std_error);</div>
<div class="line">assert(std::abs(bs_price - pde_price) &lt; 1e-6);</div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md32"></a>
Build &amp; Install</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md33"></a>
Prerequisites</h2>
<ul>
<li><b>C++20 Compiler</b>: GCC 10+, Clang 12+, or MSVC 2019+</li>
<li><b>CMake 3.16+</b>: Build system configuration</li>
<li><b>Optional</b>: OpenMP (for parallel Monte Carlo)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md34"></a>
Quick Build</h2>
<div class="fragment"><div class="line">git clone https://github.com/mateobodon/quant-pricer-cpp.git</div>
<div class="line">cd quant-pricer-cpp</div>
<div class="line">git submodule update --init --recursive</div>
<div class="line"> </div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">cmake --build build -j</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md35"></a>
Install &amp; Package</h2>
<div class="fragment"><div class="line">cmake --install build --config Release --prefix &quot;$PWD/install&quot;</div>
</div><!-- fragment --><p>The install tree publishes the <span class="tt">quant_pricer</span> library, CLI, headers, and a CMake package configuration under <span class="tt">lib/cmake/quant-pricer</span>. Downstream projects can load it with:</p>
<div class="fragment"><div class="line">find_package(quant-pricer CONFIG REQUIRED)</div>
<div class="line">target_link_libraries(my_app PRIVATE quant_pricer::quant_pricer)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md36"></a>
Advanced Configuration</h2>
<div class="fragment"><div class="line"># Enable all features</div>
<div class="line">cmake -S . -B build \</div>
<div class="line">  -DCMAKE_BUILD_TYPE=Release \</div>
<div class="line">  -DQUANT_ENABLE_OPENMP=ON \</div>
<div class="line">  -DQUANT_ENABLE_SANITIZERS=ON \</div>
<div class="line">  -DQUANT_ENABLE_CLANG_TIDY=ON</div>
<div class="line"> </div>
<div class="line">cmake --build build -j</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md37"></a>
Dependencies</h2>
<ul>
<li><b>Google Test</b>: Unit testing framework (submodule)</li>
<li><b>Google Benchmark</b>: Performance benchmarking (submodule)</li>
<li><b>PCG</b>: High-quality RNG (submodule)</li>
<li><b>OpenMP</b>: Optional parallelization support</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md39"></a>
CLI Usage</h1>
<p><b>Modern flags (recommended)</b> </p><div class="fragment"><div class="line"># Monte Carlo (Sobol + Brownian bridge), 64 steps, counter RNG, JSON output</div>
<div class="line">./build/quant_cli mc \</div>
<div class="line">  --S=100 --K=100 --r=0.03 --q=0.01 --sigma=0.20 --T=1 \</div>
<div class="line">  --paths=1000000 --seed=42 \</div>
<div class="line">  --sampler=sobol --bridge=bb --steps=64 --threads=8 \</div>
<div class="line">  --rng=counter --ci --json</div>
</div><!-- fragment --><ul>
<li><span class="tt">--rng=counter|mt19937</span> toggles between deterministic counter-based streams (default) and stateful MT19937.</li>
<li><span class="tt">--ci</span> prints mean Â± stderr and 95% CI for human-readable output (JSON always includes the fields).</li>
<li><span class="tt">--greeks</span> (MC only) adds Delta/Vega/Gamma/Theta estimates to the response; combine with <span class="tt">--ci</span> for CLI output.</li>
<li>Time-dependent schedules for MC: <span class="tt">--rate_csv=path</span>, <span class="tt">--div_csv=path</span>, <span class="tt">--vol_csv=path</span> (CSV with <span class="tt">time,value</span>, strictly increasing times). When provided, they override scalar <span class="tt">r,q,Ïƒ</span>.</li>
<li>The same schedule flags are supported in <span class="tt">pde</span> mode for piecewise-constant coefficients. Barrier MC disables the terminal-stock control variate by default; supply schedules plus <span class="tt">--cv</span> if you need the classic control.</li>
</ul>
<p><b>Legacy positional (backward compatible)</b> <span class="tt">./build/quant_cli mc &lt;S&gt; &lt;K&gt; &lt;r&gt; &lt;q&gt; &lt;sigma&gt; &lt;T&gt; &lt;paths&gt; &lt;seed&gt; &lt;antithetic:0|1&gt; &lt;qmc:0|1&gt;</span></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md40"></a>
Blackâ€“Scholes Pricing</h2>
<div class="fragment"><div class="line"># European call option</div>
<div class="line">./build/quant_cli bs 100 100 0.03 0.00 0.2 1.0 call</div>
<div class="line"># Output: 10.4506</div>
<div class="line"> </div>
<div class="line"># European put option</div>
<div class="line">./build/quant_cli bs 100 100 0.03 0.00 0.2 1.0 put</div>
<div class="line"># Output: 5.5735</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md41"></a>
Monte Carlo Pricing</h2>
<div class="fragment"><div class="line"># Standard Monte Carlo (1M paths, antithetic + control variate)</div>
<div class="line">./build/quant_cli mc 100 100 0.03 0.00 0.2 1.0 1000000 42 1 none none 1 --rng=counter --ci --json</div>
<div class="line"># Output: {&quot;price&quot;: 10.4506, &quot;std_error&quot;: 1.0e-4, &quot;ci_low&quot;: ..., &quot;threads&quot;: ..., &quot;rng&quot;: &quot;counter&quot;}</div>
<div class="line"> </div>
<div class="line"># Sobol QMC with Brownian bridge (64 time steps, explicit flags)</div>
<div class="line">./build/quant_cli mc 100 100 0.03 0.00 0.2 1.0 1000000 42 1 none none 1 \</div>
<div class="line">  --sampler=sobol_scrambled --bridge=bb --steps=64 --threads=4 --rng=counter --json</div>
<div class="line"> </div>
<div class="line"># Greeks with LR/pathwise estimators (+CI)</div>
<div class="line">./build/quant_cli mc 100 100 0.03 0.00 0.2 1.0 200000 42 1 none none 1 --greeks --ci --rng=counter --json</div>
</div><!-- fragment --><p><span class="tt">--sampler</span> accepts <span class="tt">prng</span>, <span class="tt">sobol</span>, or <span class="tt">sobol_scrambled</span>; <span class="tt">--bridge</span> accepts <span class="tt">none</span> or <span class="tt">bb</span>. <span class="tt">--steps</span> controls the number of time slices (defaults to 1 for terminal sampling) and <span class="tt">--threads</span> overrides OpenMP thread counts when available. Append <span class="tt">--json</span> on any engine to receive structured output.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md42"></a>
Barrier Options</h2>
<div class="fragment"><div class="line"># Reinerâ€“Rubinstein analytic price (down-and-out call)</div>
<div class="line">./build/quant_cli barrier bs call down out 100 95 90 0 0.02 0.00 0.2 1.0</div>
<div class="line"> </div>
<div class="line"># PRNG baseline (control variate OFF by default to avoid bias)</div>
<div class="line">./build/quant_cli barrier mc call down out 100 95 90 0 0.02 0.00 0.2 1.0 250000 424242 1 none none 128 --json</div>
<div class="line"> </div>
<div class="line"># Re-enable terminal-stock control variate explicitly (experimental)</div>
<div class="line">./build/quant_cli barrier mc call down out 100 95 90 0 0.02 0.00 0.2 1.0 250000 424242 1 none none 128 --cv --json</div>
<div class="line"> </div>
<div class="line"># Sobol + Brownian bridge (remember 64-dim limit â†’ â‰¤32 monitoring steps)</div>
<div class="line">./build/quant_cli barrier mc call down out 100 95 90 0 0.02 0.00 0.2 1.0 250000 424242 1 sobol bb 32 --sampler=sobol --bridge=bb --steps=32 --json</div>
<div class="line"> </div>
<div class="line"># Crankâ€“Nicolson PDE with absorbing boundary at S=B</div>
<div class="line">./build/quant_cli barrier pde call down out 100 95 90 0 0.02 0.00 0.2 1.0 201 200 4.0</div>
</div><!-- fragment --><p>See â€œBarrier MC crossing correctionâ€ in docs/Design.md for the withinâ€‘step hit probability and tuning tips (steps, QMC, bridge) to reduce bias/variance.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md43"></a>
PDE Pricing</h2>
<div class="fragment"><div class="line"># Crankâ€“Nicolson with log-space grid, Neumann boundary, and Rannacher damping</div>
<div class="line">./build/quant_cli pde 100 100 0.03 0.00 0.2 1.0 call 201 200 4.0 1 1 2.5 1 1 --json</div>
<div class="line"> </div>
<div class="line"># With timeâ€‘dependent schedules for r(t), q(t), Ïƒ(t)</div>
<div class="line"># Each CSV has two columns: time,value (strictly increasing times)</div>
<div class="line">./build/quant_cli pde 100 100 0.03 0.00 0.2 1.0 call 241 240 4.0 1 1 2.5 1 1 \</div>
<div class="line">  --rate_csv=data/r.csv --div_csv=data/q.csv --vol_csv=data/sigma.csv --json</div>
</div><!-- fragment --> <h2 class="doxsection"><a class="anchor" id="autotoc_md44"></a>
Exotics</h2>
<div class="fragment"><div class="line"># Asian arithmetic (geometric CV on by default)</div>
<div class="line">./build/quant_cli asian arith fixed 100 100 0.03 0.00 0.2 1.0 200000 64 42 --json</div>
<div class="line"> </div>
<div class="line"># Lookback (fixed strike call)</div>
<div class="line">./build/quant_cli lookback fixed call 100 100 0.03 0.00 0.2 1.0 120000 64 4242 --json</div>
<div class="line"> </div>
<div class="line"># Digital (cash-or-nothing call)</div>
<div class="line">./build/quant_cli digital cash call 100 100 0.03 0.00 0.2 1.0 --json</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md45"></a>
Heston</h2>
<div class="fragment"><div class="line"># Analytic Heston via CF + Gaussâ€“Laguerre</div>
<div class="line">./build/quant_cli heston 1.5 0.04 0.5 -0.5 0.04  100 100 0.01 0.00 1.0  120000 64 2025 --json</div>
<div class="line"> </div>
<div class="line"># Andersen QE Monte Carlo (counter RNG, 96 steps)</div>
<div class="line">./build/quant_cli heston 1.5 0.04 0.5 -0.5 0.04  100 100 0.01 0.00 1.0  80000 96 2025 --mc --heston-qe --rng=counter --ci --json</div>
<div class="line"> </div>
<div class="line"># Euler fallback for comparison (stateful MT19937 RNG)</div>
<div class="line">./build/quant_cli heston 1.5 0.04 0.5 -0.5 0.04  100 100 0.01 0.00 1.0  80000 96 2025 --mc --heston-euler --rng=mt19937 --json</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md46"></a>
Risk</h2>
<div class="fragment"><div class="line"># GBM VaR/CVaR for a long 1x position over 1 day</div>
<div class="line">./build/quant_cli risk gbm 100 0.0 0.2 0.004 1.0 200000 4242 0.99 --json</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md47"></a>
Reports &amp; Calibration</h2>
<div class="fragment"><div class="line"># Fetch and calibrate for a single date</div>
<div class="line">python3 scripts/data/wrds_fetch_options.py --date 2023-06-01 --underlying SPX --out data/options_2023-06-01.csv</div>
<div class="line">python3 scripts/calibrate_heston.py --csv data/options_2023-06-01.csv --out artifacts/heston_calib_20230601.json</div>
<div class="line"> </div>
<div class="line"># Build report (error heatmap, IV surface, VaR backtest, param series)</div>
<div class="line">python3 scripts/report.py \</div>
<div class="line">  --options_csv data/options_2023-06-01.csv \</div>
<div class="line">  --calib_json artifacts/heston_calib_20230601.json \</div>
<div class="line">  --returns_csv data/spy_returns.csv \</div>
<div class="line">  --series_csv artifacts/heston_series.csv \</div>
<div class="line">  --artifacts_dir artifacts</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md48"></a>
Python bindings (pip install)</h2>
<div class="fragment"><div class="line">pip install pyquant-pricer</div>
<div class="line">python -m python.examples.quickstart</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md49"></a>
Python Quickstart</h2>
<div class="fragment"><div class="line"><span class="keyword">import</span> subprocess, sys</div>
<div class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</div>
<div class="line"><span class="keyword">import</span> pyquant_pricer <span class="keyword">as</span> qp</div>
<div class="line"> </div>
<div class="line">spot = 100.0</div>
<div class="line">print(f<span class="stringliteral">&quot;Call price: {qp.bs_call(spot, 105.0, 0.02, 0.01, 0.25, 0.5):.4f}&quot;</span>)</div>
<div class="line">barrier = qp.BarrierSpec(); barrier.type = qp.BarrierType.DownOut; barrier.B = 95.0</div>
<div class="line">print(f<span class="stringliteral">&quot;Down-and-out call: {qp.barrier_bs(qp.OptionType.Call, barrier, spot, 100.0, 0.03, 0.0, 0.2, 1.0):.4f}&quot;</span>)</div>
<div class="line"> </div>
<div class="line">market = qp.HestonMarket()</div>
<div class="line">market.spot = spot</div>
<div class="line">market.strike = 100.0</div>
<div class="line">market.rate = 0.01</div>
<div class="line">market.dividend = 0.0</div>
<div class="line">market.time = 1.0</div>
<div class="line"> </div>
<div class="line">params = qp.HestonParams()</div>
<div class="line">params.kappa = 1.5</div>
<div class="line">params.theta = 0.04</div>
<div class="line">params.sigma = 0.5</div>
<div class="line">params.rho = -0.5</div>
<div class="line">params.v0 = 0.04</div>
<div class="line"> </div>
<div class="line">iv = qp.heston_implied_vol(market, params)</div>
<div class="line">phi = qp.heston_characteristic_fn(1.0, market, params)</div>
<div class="line">print(f<span class="stringliteral">&quot;Heston IV {iv:.4%} | phi(1) = {phi.real:.4f} + {phi.imag:.4f}i&quot;</span>)</div>
<div class="line"> </div>
<div class="line">repo_root = Path(__file__).resolve().parents[2]</div>
<div class="line">surface = next((repo_root / <span class="stringliteral">&quot;data&quot;</span> / <span class="stringliteral">&quot;samples&quot;</span>).glob(<span class="stringliteral">&quot;spx_*.csv&quot;</span>), <span class="keywordtype">None</span>)</div>
<div class="line"><span class="keywordflow">if</span> surface:</div>
<div class="line">    subprocess.run([sys.executable, repo_root / <span class="stringliteral">&quot;scripts&quot;</span> / <span class="stringliteral">&quot;calibrate_heston.py&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;--input&quot;</span>, surface, <span class="stringliteral">&quot;--fast&quot;</span>, <span class="stringliteral">&quot;--metric&quot;</span>, <span class="stringliteral">&quot;price&quot;</span>], check=<span class="keyword">True</span>)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md50"></a>
Python bindings (dev workflow)</h2>
<div class="fragment"><div class="line"># Use the in-tree module during development</div>
<div class="line">PYTHONPATH=build/python python3 scripts/greeks_variance.py --artifacts artifacts</div>
<div class="line">PYTHONPATH=build/python python3 scripts/multiasset_figures.py --artifacts artifacts</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Crankâ€“Nicolson with log-space grid, Neumann boundary, and Rannacher damping</div>
<div class="line">./build/quant_cli pde 100 100 0.03 0.00 0.2 1.0 call 201 200 4.0 1 1 2.5 1 1 --json</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md51"></a>
American Options</h2>
<div class="fragment"><div class="line"># PSOR benchmark (log-space, Neumann boundary)</div>
<div class="line">./build/quant_cli american psor put 95 100 0.03 0.01 0.2 1.0 201 200 4.0 1 1 2.0 1.5 8000 1e-7 --json</div>
<div class="line"> </div>
<div class="line"># Longstaffâ€“Schwartz Monte Carlo (antithetic off for basis stability)</div>
<div class="line">./build/quant_cli american lsmc put 95 100 0.03 0.01 0.2 1.0 200000 64 2025 0 --json</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md52"></a>
Parameter Exploration</h2>
<div class="fragment"><div class="line"># Compare methods for different strikes</div>
<div class="line">for K in 90 95 100 105 110; do</div>
<div class="line">  echo &quot;Strike $K:&quot;</div>
<div class="line">  echo &quot;  BS:  $(./build/quant_cli bs 100 $K 0.03 0.00 0.2 1.0 call)&quot;</div>
<div class="line">  echo &quot;  MC:  $(./build/quant_cli mc 100 $K 0.03 0.00 0.2 1.0 200000 42 1 none none 1)&quot;</div>
<div class="line">  echo &quot;  PDE: $(./build/quant_cli pde 100 $K 0.03 0.00 0.2 1.0 call 201 200 4.0 1 1 0 1)&quot;</div>
<div class="line">done</div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md54"></a>
Library API Overview</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md55"></a>
Blackâ€“Scholes Namespace</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequant_1_1bs.html">quant::bs</a> {</div>
<div class="line">    <span class="comment">// Core pricing functions</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#acc9f587fb3ed3d7184ffda96a3fa5f57">call_price</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a00d516315414017217f337c4858ee7ba">put_price</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Greeks</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#af383ac3055e6844548cc05236a5b827c">delta_call</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#aca0f174afc1912a408f8af0f33909690">delta_put</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a6fe4a94909b796d278623004a73f7ac1">gamma</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a440d4850067e734dbc14d96ac291e928">vega</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a2c90ce2ed9f48be955e754ecf608e7dc">theta_call</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#aa03bef881465fd01a447ef99491ecf7c">theta_put</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a4a5da0da63b00eee7408e218803b289d">rho_call</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a9dbfa65819b0206ad9e953ae44a93bc6">rho_put</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Utility functions</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#acd0367b3991986279b59df47ea140332">normal_pdf</a>(<span class="keywordtype">double</span> x);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a792f34b4535a8cf0bacadf766540be46">normal_cdf</a>(<span class="keywordtype">double</span> x);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#aa014d8d6c8cfe28b9022838526bb4c91">d1</a>(<span class="keywordtype">double</span> S, <span class="keywordtype">double</span> K, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1bs.html#a6696ec0b9f66dc6bb2e9fcd1edce1400">d2</a>(<span class="keywordtype">double</span> d1_value, <span class="keywordtype">double</span> sigma, <span class="keywordtype">double</span> T);</div>
<div class="line">}</div>
<div class="ttc" id="anamespacequant_1_1bs_html"><div class="ttname"><a href="namespacequant_1_1bs.html">quant::bs</a></div><div class="ttdoc">Analytic Blackâ€“Scholes European option pricing and Greeks.</div><div class="ttdef"><b>Definition</b> black_scholes.hpp:6</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a00d516315414017217f337c4858ee7ba"><div class="ttname"><a href="namespacequant_1_1bs.html#a00d516315414017217f337c4858ee7ba">quant::bs::put_price</a></div><div class="ttdeci">double put_price(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdoc">Price a European put option under Blackâ€“Scholes (present value).</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:23</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a6696ec0b9f66dc6bb2e9fcd1edce1400"><div class="ttname"><a href="namespacequant_1_1bs.html#a6696ec0b9f66dc6bb2e9fcd1edce1400">quant::bs::d2</a></div><div class="ttdeci">double d2(double d1_value, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.hpp:56</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a792f34b4535a8cf0bacadf766540be46"><div class="ttname"><a href="namespacequant_1_1bs.html#a792f34b4535a8cf0bacadf766540be46">quant::bs::normal_cdf</a></div><div class="ttdeci">double normal_cdf(double x)</div><div class="ttdef"><b>Definition</b> black_scholes.hpp:21</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_a9dbfa65819b0206ad9e953ae44a93bc6"><div class="ttname"><a href="namespacequant_1_1bs.html#a9dbfa65819b0206ad9e953ae44a93bc6">quant::bs::rho_put</a></div><div class="ttdeci">double rho_put(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:136</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_aa014d8d6c8cfe28b9022838526bb4c91"><div class="ttname"><a href="namespacequant_1_1bs.html#aa014d8d6c8cfe28b9022838526bb4c91">quant::bs::d1</a></div><div class="ttdeci">double d1(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.hpp:46</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_aa03bef881465fd01a447ef99491ecf7c"><div class="ttname"><a href="namespacequant_1_1bs.html#aa03bef881465fd01a447ef99491ecf7c">quant::bs::theta_put</a></div><div class="ttdeci">double theta_put(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:96</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_aca0f174afc1912a408f8af0f33909690"><div class="ttname"><a href="namespacequant_1_1bs.html#aca0f174afc1912a408f8af0f33909690">quant::bs::delta_put</a></div><div class="ttdeci">double delta_put(double S, double K, double r, double q, double sigma, double T)</div><div class="ttdef"><b>Definition</b> black_scholes.cpp:47</div></div>
<div class="ttc" id="anamespacequant_1_1bs_html_acd0367b3991986279b59df47ea140332"><div class="ttname"><a href="namespacequant_1_1bs.html#acd0367b3991986279b59df47ea140332">quant::bs::normal_pdf</a></div><div class="ttdeci">double normal_pdf(double x)</div><div class="ttdef"><b>Definition</b> black_scholes.hpp:12</div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md56"></a>
Monte Carlo Namespace</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequant_1_1mc.html">quant::mc</a> {</div>
<div class="line">    <span class="keyword">struct </span>McParams {</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a076a94b0cf26e7b12446a65983f9b0d8">spot</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#abe87b0f9b9ee8d9ff58ef91489837577">strike</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#af59d455ad088c460892e04609ad3194d">rate</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#af41771f9ad14275fa0d800ccac10758f">dividend</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a99903a7ceec2f029f03dedf475698a3a">vol</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#aeaf4267b75340a962090b3537d5ef145">time</a>;</div>
<div class="line">        std::uint64_t <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#ac9b4891a05f528deb9fe2070ad460e19">num_paths</a>, <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a9214a623c57f1bf9dd0f9507b7089d84">seed</a>;</div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#ac90a8c9a299af98d84663cce4f40db32">antithetic</a>;</div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#aaf22f442a8e989bf007de4c746a60860">control_variate</a>;</div>
<div class="line">        <span class="keyword">enum class</span> <a class="code hl_enumeration" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706c">Qmc</a> { <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca6adf97f83acf6453d4a6a4b1070f3754">None</a>, <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75">Sobol</a>, <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca1946dc00e20d51896b77d0f3914a6318">SobolScrambled</a> } <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a5c80140993b18711dcb84bdfd0360553">qmc</a>;</div>
<div class="line">        <span class="keyword">enum class</span> <a class="code hl_enumeration" href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144d">Bridge</a> { <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca6adf97f83acf6453d4a6a4b1070f3754">None</a>, <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae">BrownianBridge</a> } <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a847477f8fc5bdda86e975f9e908e06b8">bridge</a>;</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a9d2c0888bdb4cc99bad3e6d54488f084">num_steps</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="structquant_1_1mc_1_1_mc_statistic.html">McStatistic</a> {</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_statistic.html#a70640537fd08fb17fd055db79315a3f4">value</a>;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_statistic.html#a1458634ee5fdcf2f3223b370ec8e72bd">std_error</a>;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_statistic.html#aeadd12f59c1532cfb5af201978ecda3b">ci_low</a>;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_statistic.html#a5f2a01cb409e456d671160c5af28a874">ci_high</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="structquant_1_1mc_1_1_mc_result.html">McResult</a> {</div>
<div class="line">        McStatistic <a class="code hl_variable" href="structquant_1_1mc_1_1_mc_result.html#aa579d68974696d3067c24eb141f05b2b">estimate</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="structquant_1_1mc_1_1_greeks_result.html">GreeksResult</a> {</div>
<div class="line">        McStatistic <a class="code hl_variable" href="structquant_1_1mc_1_1_greeks_result.html#ad864c736e84be91804bb1cd8fdb727ba">delta</a>;</div>
<div class="line">        McStatistic <a class="code hl_variable" href="structquant_1_1mc_1_1_greeks_result.html#a7e4df9ba06855e15b3c7aa0a95eea003">vega</a>;</div>
<div class="line">        McStatistic <a class="code hl_variable" href="structquant_1_1mc_1_1_greeks_result.html#ab001673ecc45025fb9cda2d5c8e0684c">gamma_lrm</a>;</div>
<div class="line">        McStatistic <a class="code hl_variable" href="structquant_1_1mc_1_1_greeks_result.html#a21361a8b3141f125154f0f2aaac601fd">gamma_mixed</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="structquant_1_1mc_1_1_mc_result.html">McResult</a> <a class="code hl_function" href="namespacequant_1_1mc.html#a359142f9f448fda8bd468a8297093efc">price_european_call</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structquant_1_1mc_1_1_mc_params.html">McParams</a>&amp; p);</div>
<div class="line">    <a class="code hl_struct" href="structquant_1_1mc_1_1_greeks_result.html">GreeksResult</a> <a class="code hl_function" href="namespacequant_1_1mc.html#a5ed0f2a042a71e0a79981184cc74ce43">greeks_european_call</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structquant_1_1mc_1_1_mc_params.html">McParams</a>&amp; p);</div>
<div class="line">}</div>
<div class="ttc" id="anamespacequant_1_1mc_html"><div class="ttname"><a href="namespacequant_1_1mc.html">quant::mc</a></div><div class="ttdoc">Monte Carlo GBM pricer with antithetic variates and optional control variate.</div><div class="ttdef"><b>Definition</b> mc.hpp:12</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_greeks_result_html"><div class="ttname"><a href="structquant_1_1mc_1_1_greeks_result.html">quant::mc::GreeksResult</a></div><div class="ttdoc">Monte Carlo Greeks result (mean/SE/CI per estimator).</div><div class="ttdef"><b>Definition</b> mc.hpp:61</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_greeks_result_html_a21361a8b3141f125154f0f2aaac601fd"><div class="ttname"><a href="structquant_1_1mc_1_1_greeks_result.html#a21361a8b3141f125154f0f2aaac601fd">quant::mc::GreeksResult::gamma_mixed</a></div><div class="ttdeci">McStatistic gamma_mixed</div><div class="ttdef"><b>Definition</b> mc.hpp:65</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_greeks_result_html_a7e4df9ba06855e15b3c7aa0a95eea003"><div class="ttname"><a href="structquant_1_1mc_1_1_greeks_result.html#a7e4df9ba06855e15b3c7aa0a95eea003">quant::mc::GreeksResult::vega</a></div><div class="ttdeci">McStatistic vega</div><div class="ttdef"><b>Definition</b> mc.hpp:63</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_greeks_result_html_ab001673ecc45025fb9cda2d5c8e0684c"><div class="ttname"><a href="structquant_1_1mc_1_1_greeks_result.html#ab001673ecc45025fb9cda2d5c8e0684c">quant::mc::GreeksResult::gamma_lrm</a></div><div class="ttdeci">McStatistic gamma_lrm</div><div class="ttdef"><b>Definition</b> mc.hpp:64</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_greeks_result_html_ad864c736e84be91804bb1cd8fdb727ba"><div class="ttname"><a href="structquant_1_1mc_1_1_greeks_result.html#ad864c736e84be91804bb1cd8fdb727ba">quant::mc::GreeksResult::delta</a></div><div class="ttdeci">McStatistic delta</div><div class="ttdef"><b>Definition</b> mc.hpp:62</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a076a94b0cf26e7b12446a65983f9b0d8"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a076a94b0cf26e7b12446a65983f9b0d8">quant::mc::McParams::spot</a></div><div class="ttdeci">double spot</div><div class="ttdef"><b>Definition</b> mc.hpp:18</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a411a107ecb4358d02633a2f8e2fb144d"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144d">quant::mc::McParams::Bridge</a></div><div class="ttdeci">Bridge</div><div class="ttdef"><b>Definition</b> mc.hpp:30</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a6590300ef4c0f6f960ad4161d0ed706c"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706c">quant::mc::McParams::Qmc</a></div><div class="ttdeci">Qmc</div><div class="ttdef"><b>Definition</b> mc.hpp:29</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a6590300ef4c0f6f960ad4161d0ed706ca1946dc00e20d51896b77d0f3914a6318"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca1946dc00e20d51896b77d0f3914a6318">quant::mc::McParams::Qmc::SobolScrambled</a></div><div class="ttdeci">@ SobolScrambled</div><div class="ttdef"><b>Definition</b> mc.hpp:29</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a6590300ef4c0f6f960ad4161d0ed706ca6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca6adf97f83acf6453d4a6a4b1070f3754">quant::mc::McParams::Qmc::None</a></div><div class="ttdeci">@ None</div><div class="ttdef"><b>Definition</b> mc.hpp:29</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a99903a7ceec2f029f03dedf475698a3a"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a99903a7ceec2f029f03dedf475698a3a">quant::mc::McParams::vol</a></div><div class="ttdeci">double vol</div><div class="ttdef"><b>Definition</b> mc.hpp:22</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_a9d2c0888bdb4cc99bad3e6d54488f084"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#a9d2c0888bdb4cc99bad3e6d54488f084">quant::mc::McParams::num_steps</a></div><div class="ttdeci">int num_steps</div><div class="ttdef"><b>Definition</b> mc.hpp:33</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_abe87b0f9b9ee8d9ff58ef91489837577"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#abe87b0f9b9ee8d9ff58ef91489837577">quant::mc::McParams::strike</a></div><div class="ttdeci">double strike</div><div class="ttdef"><b>Definition</b> mc.hpp:19</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_ac9b4891a05f528deb9fe2070ad460e19"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#ac9b4891a05f528deb9fe2070ad460e19">quant::mc::McParams::num_paths</a></div><div class="ttdeci">std::uint64_t num_paths</div><div class="ttdef"><b>Definition</b> mc.hpp:24</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_aeaf4267b75340a962090b3537d5ef145"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#aeaf4267b75340a962090b3537d5ef145">quant::mc::McParams::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition</b> mc.hpp:23</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_af41771f9ad14275fa0d800ccac10758f"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#af41771f9ad14275fa0d800ccac10758f">quant::mc::McParams::dividend</a></div><div class="ttdeci">double dividend</div><div class="ttdef"><b>Definition</b> mc.hpp:21</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_params_html_af59d455ad088c460892e04609ad3194d"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_params.html#af59d455ad088c460892e04609ad3194d">quant::mc::McParams::rate</a></div><div class="ttdeci">double rate</div><div class="ttdef"><b>Definition</b> mc.hpp:20</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_result_html"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_result.html">quant::mc::McResult</a></div><div class="ttdoc">Monte Carlo pricing result.</div><div class="ttdef"><b>Definition</b> mc.hpp:49</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_result_html_aa579d68974696d3067c24eb141f05b2b"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_result.html#aa579d68974696d3067c24eb141f05b2b">quant::mc::McResult::estimate</a></div><div class="ttdeci">McStatistic estimate</div><div class="ttdef"><b>Definition</b> mc.hpp:50</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_statistic_html"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_statistic.html">quant::mc::McStatistic</a></div><div class="ttdoc">Summary of a Monte Carlo estimator (mean, standard error, 95% CI).</div><div class="ttdef"><b>Definition</b> mc.hpp:41</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_statistic_html_a1458634ee5fdcf2f3223b370ec8e72bd"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_statistic.html#a1458634ee5fdcf2f3223b370ec8e72bd">quant::mc::McStatistic::std_error</a></div><div class="ttdeci">double std_error</div><div class="ttdef"><b>Definition</b> mc.hpp:43</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_statistic_html_a5f2a01cb409e456d671160c5af28a874"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_statistic.html#a5f2a01cb409e456d671160c5af28a874">quant::mc::McStatistic::ci_high</a></div><div class="ttdeci">double ci_high</div><div class="ttdef"><b>Definition</b> mc.hpp:45</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_statistic_html_a70640537fd08fb17fd055db79315a3f4"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_statistic.html#a70640537fd08fb17fd055db79315a3f4">quant::mc::McStatistic::value</a></div><div class="ttdeci">double value</div><div class="ttdef"><b>Definition</b> mc.hpp:42</div></div>
<div class="ttc" id="astructquant_1_1mc_1_1_mc_statistic_html_aeadd12f59c1532cfb5af201978ecda3b"><div class="ttname"><a href="structquant_1_1mc_1_1_mc_statistic.html#aeadd12f59c1532cfb5af201978ecda3b">quant::mc::McStatistic::ci_low</a></div><div class="ttdeci">double ci_low</div><div class="ttdef"><b>Definition</b> mc.hpp:44</div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md57"></a>
PDE Namespace</h2>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacequant_1_1pde.html">quant::pde</a> {</div>
<div class="line">    <span class="keyword">struct </span>GridSpec {</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code hl_variable" href="structquant_1_1pde_1_1_grid_spec.html#a3394ea9a236b63d9085f59618322f4ba">num_space</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_grid_spec.html#ad8faba773bb3cd9c8361bb93e408143d">num_time</a>;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1pde_1_1_grid_spec.html#a5781a6510495783f44747aa9728fe24b">s_max_mult</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>PdeParams {</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#ab087353d8aabdc88823df4f9d001f8f6">spot</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#acb89213619fabc42690b0a3affe6e125">strike</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#a2f63b028f0770bdcb441a961ad83b483">rate</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#ad660ceccc13865ab475bfcf27e497239">dividend</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#abf6160681463f15f3d4cfc7c5cf1e044">vol</a>, <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#aaae8383b3b9d28ec8fe8fc2746dda059">time</a>;</div>
<div class="line">        <a class="code hl_enumeration" href="american_8cpp.html#ac5c3ed56e7e0c04487a55095e021afeb">OptionType</a> <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#a57c51559845e9e2e9555bfb464a77ad4">type</a>;</div>
<div class="line">        GridSpec <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#adda4a423dfe3a8aa0ba650532b11d3b0">grid</a>;</div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#a6a1f4845a3a322dc9a7ab71b60bd580b">log_space</a>;</div>
<div class="line">        <span class="keyword">enum class</span> <a class="code hl_enumeration" href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38">UpperBoundary</a> { <a class="code hl_enumvalue" href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38abac152b762896edff34ed668ae1a546f">Dirichlet</a>, <a class="code hl_enumvalue" href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38ab8537a769dbc90cb1762215441212152">Neumann</a> } <a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#af5b9f02c0d3103824e8aca43a62dfd81">upper_boundary</a>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="namespacequant_1_1pde.html#a04f166d2e994def76cd8ff8d4fc7fa0b">price_crank_nicolson</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structquant_1_1pde_1_1_pde_params.html">PdeParams</a>&amp; p);</div>
<div class="line">    std::vector&lt;double&gt; <a class="code hl_function" href="namespacequant_1_1pde.html#a84ee3fd8f79fdcc4554216600d953a5a">solve_tridiagonal</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; a,</div>
<div class="line">                                         <span class="keyword">const</span> std::vector&lt;double&gt;&amp; b,</div>
<div class="line">                                         <span class="keyword">const</span> std::vector&lt;double&gt;&amp; c,</div>
<div class="line">                                         <span class="keyword">const</span> std::vector&lt;double&gt;&amp; d);</div>
<div class="line">}</div>
<div class="ttc" id="aamerican_8cpp_html_ac5c3ed56e7e0c04487a55095e021afeb"><div class="ttname"><a href="american_8cpp.html#ac5c3ed56e7e0c04487a55095e021afeb">OptionType</a></div><div class="ttdeci">OptionType</div><div class="ttdef"><b>Definition</b> barrier.hpp:6</div></div>
<div class="ttc" id="anamespacequant_1_1pde_html"><div class="ttname"><a href="namespacequant_1_1pde.html">quant::pde</a></div><div class="ttdoc">Finite-difference PDE pricer (Crankâ€“Nicolson) for European options.</div><div class="ttdef"><b>Definition</b> pde.hpp:10</div></div>
<div class="ttc" id="anamespacequant_1_1pde_html_a84ee3fd8f79fdcc4554216600d953a5a"><div class="ttname"><a href="namespacequant_1_1pde.html#a84ee3fd8f79fdcc4554216600d953a5a">quant::pde::solve_tridiagonal</a></div><div class="ttdeci">std::vector&lt; double &gt; solve_tridiagonal(const std::vector&lt; double &gt; &amp;a, const std::vector&lt; double &gt; &amp;b, const std::vector&lt; double &gt; &amp;c, const std::vector&lt; double &gt; &amp;d)</div><div class="ttdef"><b>Definition</b> pde.cpp:154</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_grid_spec_html_a3394ea9a236b63d9085f59618322f4ba"><div class="ttname"><a href="structquant_1_1pde_1_1_grid_spec.html#a3394ea9a236b63d9085f59618322f4ba">quant::pde::GridSpec::num_space</a></div><div class="ttdeci">int num_space</div><div class="ttdef"><b>Definition</b> pde.hpp:14</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_grid_spec_html_a5781a6510495783f44747aa9728fe24b"><div class="ttname"><a href="structquant_1_1pde_1_1_grid_spec.html#a5781a6510495783f44747aa9728fe24b">quant::pde::GridSpec::s_max_mult</a></div><div class="ttdeci">double s_max_mult</div><div class="ttdef"><b>Definition</b> pde.hpp:16</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_grid_spec_html_ad8faba773bb3cd9c8361bb93e408143d"><div class="ttname"><a href="structquant_1_1pde_1_1_grid_spec.html#ad8faba773bb3cd9c8361bb93e408143d">quant::pde::GridSpec::num_time</a></div><div class="ttdeci">int num_time</div><div class="ttdef"><b>Definition</b> pde.hpp:15</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_a2f63b028f0770bdcb441a961ad83b483"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#a2f63b028f0770bdcb441a961ad83b483">quant::pde::PdeParams::rate</a></div><div class="ttdeci">double rate</div><div class="ttdef"><b>Definition</b> pde.hpp:32</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_a57c51559845e9e2e9555bfb464a77ad4"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#a57c51559845e9e2e9555bfb464a77ad4">quant::pde::PdeParams::type</a></div><div class="ttdeci">::quant::OptionType type</div><div class="ttdef"><b>Definition</b> pde.hpp:36</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_a6a1f4845a3a322dc9a7ab71b60bd580b"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#a6a1f4845a3a322dc9a7ab71b60bd580b">quant::pde::PdeParams::log_space</a></div><div class="ttdeci">bool log_space</div><div class="ttdoc">Use log-space grid x = ln(S) for improved stability near boundaries.</div><div class="ttdef"><b>Definition</b> pde.hpp:39</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_aaae8383b3b9d28ec8fe8fc2746dda059"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#aaae8383b3b9d28ec8fe8fc2746dda059">quant::pde::PdeParams::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition</b> pde.hpp:35</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_ab087353d8aabdc88823df4f9d001f8f6"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#ab087353d8aabdc88823df4f9d001f8f6">quant::pde::PdeParams::spot</a></div><div class="ttdeci">double spot</div><div class="ttdef"><b>Definition</b> pde.hpp:30</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_abf6160681463f15f3d4cfc7c5cf1e044"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#abf6160681463f15f3d4cfc7c5cf1e044">quant::pde::PdeParams::vol</a></div><div class="ttdeci">double vol</div><div class="ttdef"><b>Definition</b> pde.hpp:34</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_acb89213619fabc42690b0a3affe6e125"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#acb89213619fabc42690b0a3affe6e125">quant::pde::PdeParams::strike</a></div><div class="ttdeci">double strike</div><div class="ttdef"><b>Definition</b> pde.hpp:31</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_ad660ceccc13865ab475bfcf27e497239"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#ad660ceccc13865ab475bfcf27e497239">quant::pde::PdeParams::dividend</a></div><div class="ttdeci">double dividend</div><div class="ttdef"><b>Definition</b> pde.hpp:33</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_adda4a423dfe3a8aa0ba650532b11d3b0"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#adda4a423dfe3a8aa0ba650532b11d3b0">quant::pde::PdeParams::grid</a></div><div class="ttdeci">GridSpec grid</div><div class="ttdef"><b>Definition</b> pde.hpp:37</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_ae4220bab8d7f7a4e52c868d188d41f38"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38">quant::pde::PdeParams::UpperBoundary</a></div><div class="ttdeci">UpperBoundary</div><div class="ttdoc">Upper boundary condition type.</div><div class="ttdef"><b>Definition</b> pde.hpp:41</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_ae4220bab8d7f7a4e52c868d188d41f38abac152b762896edff34ed668ae1a546f"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38abac152b762896edff34ed668ae1a546f">quant::pde::PdeParams::UpperBoundary::Dirichlet</a></div><div class="ttdeci">@ Dirichlet</div><div class="ttdef"><b>Definition</b> pde.hpp:41</div></div>
<div class="ttc" id="astructquant_1_1pde_1_1_pde_params_html_af5b9f02c0d3103824e8aca43a62dfd81"><div class="ttname"><a href="structquant_1_1pde_1_1_pde_params.html#af5b9f02c0d3103824e8aca43a62dfd81">quant::pde::PdeParams::upper_boundary</a></div><div class="ttdeci">UpperBoundary upper_boundary</div><div class="ttdef"><b>Definition</b> pde.hpp:42</div></div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md59"></a>
Validation &amp; Results</h1>
<p><em>See also: docs/ValidationHighlights.md for the most recent artifact snapshot produced by <span class="tt">scripts/reproduce_all.sh</span> (outputs live under <span class="tt">docs/artifacts/</span>).</em></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
Cross-Method Validation</h2>
<p>The library implements rigorous cross-validation between all three pricing methods:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method  </th><th class="markdownTableHeadNone">1M Paths MC  </th><th class="markdownTableHeadNone">PDE (201Ã—200)  </th><th class="markdownTableHeadNone">Blackâ€“Scholes  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Call Price</b>  </td><td class="markdownTableBodyNone">10.4506 Â± 0.0001  </td><td class="markdownTableBodyNone">10.4506  </td><td class="markdownTableBodyNone">10.4506  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Put Price</b>  </td><td class="markdownTableBodyNone">5.5735 Â± 0.0001  </td><td class="markdownTableBodyNone">5.5735  </td><td class="markdownTableBodyNone">5.5735  </td></tr>
</table>
<h3 class="doxsection"><a class="anchor" id="autotoc_md61"></a>
MC Greeks vs Blackâ€“Scholes (800k paths, antithetic; S=K=100, r=3%, q=1%, Ïƒ=20%, T=1)</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Greek  </th><th class="markdownTableHeadNone">MC Mean  </th><th class="markdownTableHeadNone">Std Err  </th><th class="markdownTableHeadNone">95% CI  </th><th class="markdownTableHeadNone">Blackâ€“Scholes  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Î” (pathwise)</b>  </td><td class="markdownTableBodyNone">0.573485  </td><td class="markdownTableBodyNone">8.24e-05  </td><td class="markdownTableBodyNone">[0.573323, 0.573646]  </td><td class="markdownTableBodyNone">0.573496  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Î½ (pathwise)</b>  </td><td class="markdownTableBodyNone">38.7084  </td><td class="markdownTableBodyNone">4.97e-02  </td><td class="markdownTableBodyNone">[38.6110, 38.8058]  </td><td class="markdownTableBodyNone">38.7152  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Î“ (LRM)</b>  </td><td class="markdownTableBodyNone">0.0193238  </td><td class="markdownTableBodyNone">1.01e-04  </td><td class="markdownTableBodyNone">[0.0191250, 0.0195227]  </td><td class="markdownTableBodyNone">0.0193576  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Î“ (mixed)</b>  </td><td class="markdownTableBodyNone">0.0193542  </td><td class="markdownTableBodyNone">2.49e-05  </td><td class="markdownTableBodyNone">[0.0193055, 0.0194029]  </td><td class="markdownTableBodyNone">0.0193576  </td></tr>
</table>
<p>The mixed gamma estimator trims the standard error by ~4Ã— versus the pure LRM estimator while remaining unbiased, matching the Blackâ€“Scholes benchmark within the tighter confidence band.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md62"></a>
Convergence Analysis</h2>
<p><b>Monte Carlo Convergence:</b> <span class="tt">docs/artifacts/qmc_vs_prng_equal_time.csv</span> shows Sobol + Brownian bridge cutting RMSE to 0.02398 (vs 0.03435) under the same time budgetâ€”roughly a 1.4Ã— gain once the budget allows â‰¥8k paths.</p>
<p><b>Heston QE vs Euler:</b> <span class="tt">docs/artifacts/heston_qe_vs_analytic.csv</span> captures Andersen's QE scheme against the legacy Euler discretisation across 16â€“128 steps (80k paths). QE tracks the analytic price within ~1.3â€¯e-4 at 64 steps while Euler lags by &gt;2Ã—, and the PNG shows logarithmic convergence with the counter-based RNG keeping dispersion stable across threads.</p>
<p><b>PDE Convergence:</b> <span class="tt">docs/artifacts/pde_order_slope.csv</span> confirms â‰ˆsecond-order behaviour (slope âˆ’2.0). Price errors shrink from 4.98Ã—10â»Â³ on a 101Ã—100 grid to 8.0Ã—10â»âµ on an 801Ã—400 grid while Î”/Î“ stay within 10â»âµ of Blackâ€“Scholes.</p>
<p>The reproduction script also writes plotsâ€”<span class="tt">docs/artifacts/qmc_vs_prng_equal_time.png</span> compares equal-time RMSE reductions, <span class="tt">docs/artifacts/heston_qe_vs_analytic.png</span> visualises QE vs Euler convergence, and <span class="tt">docs/artifacts/mc_greeks_ci.png</span> overlays MC Greeks with 95â€¯% confidence bands.</p>
<p>Barrier validation is captured via <span class="tt">artifacts/barrier_validation.csv</span> and <span class="tt">artifacts/barrier_validation.png</span>, comparing Monte Carlo and PDE prices against Reinerâ€“Rubinstein closed-form benchmarks for representative up/down knock-out cases.</p>
<p><span class="tt">artifacts/pde_order_slope.csv</span> and <span class="tt">artifacts/pde_order_slope.png</span> record logâ€“log error curves versus grid size, demonstrating the expected â‰ˆ second-order slope once the two Rannacher start-up steps have smoothed the payoff kink.</p>
<p><span class="tt">artifacts/greeks_ci.csv</span> tabulates Delta/Vega/Gamma/Theta alongside their standard errors and 95â€¯% confidence limits (likelihood-ratio Theta, mixed Gamma). These match Blackâ€“Scholes within the CI width and feed directly into downstream dashboards.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md63"></a>
Edge Case Validation</h2>
<p><b>Zero Volatility:</b> </p><div class="fragment"><div class="line"><span class="comment">// S=130, K=100, Ïƒ=0, T=0.5</span></div>
<div class="line"><span class="comment">// Call: max(0, S*e^(-qT) - K*e^(-rT)) = 30.0 âœ“</span></div>
<div class="line"><span class="comment">// Put: max(0, K*e^(-rT) - S*e^(-qT)) = 0.0 âœ“</span></div>
</div><!-- fragment --><p><b>Zero Time:</b> </p><div class="fragment"><div class="line"><span class="comment">// S=95, K=100, T=0</span></div>
<div class="line"><span class="comment">// Call: max(0, S-K) = 0.0 âœ“</span></div>
<div class="line"><span class="comment">// Put: max(0, K-S) = 5.0 âœ“</span></div>
</div><!-- fragment --><p><b>Put-Call Parity:</b> </p><div class="fragment"><div class="line"><span class="comment">// C - P = S*e^(-qT) - K*e^(-rT)</span></div>
<div class="line"><span class="comment">// Validated to machine precision (1e-15) âœ“</span></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md64"></a>
Reproduce Validation Artifacts</h2>
<p>Run <span class="tt">./scripts/reproduce_all.sh</span> to build Release, execute the FAST + SLOW test labels, and regenerate the validation bundle under <span class="tt">docs/artifacts/</span>. The script refreshes <span class="tt">docs/artifacts/manifest.json</span> with compiler, git SHA, RNG, and CLI metadata. Set <span class="tt">REPRO_FAST=1</span> to shrink workloads or <span class="tt">SKIP_SLOW=1</span> if you're iterating locally and only need the deterministic CSV/PNGs.</p>
<ul>
<li>Looking for quick links? Browse docs/Results.md or open the PNG/CSV pairs directly inside <span class="tt">docs/artifacts/</span>.</li>
<li>Need to rerun one plot? Each helper in <span class="tt">scripts/</span> (e.g., <span class="tt">qmc_vs_prng_equal_time.py</span>, <span class="tt">pde_order_slope.py</span>) accepts <span class="tt">--output/--csv</span> so you can regenerate a single artifact in isolation.</li>
<li>Legacy <span class="tt">scripts/demo.sh</span> remains for the broader PDF deck (<span class="tt">artifacts/onepager.pdf</span>, <span class="tt">artifacts/twopager.pdf</span>) if you still need that resume-ready snapshot.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md65"></a>
Artifact index</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">File  </th><th class="markdownTableHeadNone">What it shows  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">docs/artifacts/qmc_vs_prng_equal_time.png</span>  </td><td class="markdownTableBodyNone">Sobol vs PRNG RMSE decay (European + Asian GBM) with equal-time slope annotation.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">docs/artifacts/pde_order_slope.png</span>  </td><td class="markdownTableBodyNone">Crankâ€“Nicolson + Rannacher grid slope and sub-1e-4 price errors on fine meshes.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">docs/artifacts/mc_greeks_ci.png</span>  </td><td class="markdownTableBodyNone">Delta/Vega/Gamma/Theta Â±95â€¯% confidence intervals using deterministic counter RNG.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">docs/artifacts/heston_qe_vs_analytic.png</span>  </td><td class="markdownTableBodyNone">Andersen QE vs Euler absolute error vs time steps against the analytic benchmark.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">docs/artifacts/manifest.json</span>  </td><td class="markdownTableBodyNone">Deterministic metadata: compiler, git SHA, seeds, RNG mode, and CLI commands per artifact.  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md67"></a>
Benchmarks</h1>
<p>Reusable Google Benchmark snapshots live in <span class="tt">docs/artifacts/bench/</span> (JSON from the executables, converted into CSV + PNG via <span class="tt">scripts/generate_bench_artifacts.py</span>). Regenerate everything with <span class="tt">cmake --build build --target bench</span> (or <span class="tt">make bench</span>), then rerun the helper script.</p>
<ul>
<li><a href="docs/artifacts/bench/bench_mc_paths.png"><img src="docs/artifacts/bench/bench_mc_paths.png" alt="MC throughput" width="320" class="inline"/></a> <a href="docs/artifacts/bench/bench_mc_rmse.png"><img src="docs/artifacts/bench/bench_mc_rmse.png" alt="MC RMSE" width="320" class="inline"/></a></li>
<li><a href="docs/artifacts/bench/bench_pde_walltime.png"><img src="docs/artifacts/bench/bench_pde_walltime.png" alt="PDE wall time" width="320" class="inline"/></a> <a href="docs/artifacts/bench/bench_psor_iterations.png"><img src="docs/artifacts/bench/bench_psor_iterations.png" alt="PSOR iterations" width="320" class="inline"/></a></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md68"></a>
Performance Characteristics</h2>
<p><b>Monte Carlo (1M paths, Release build):</b> </p><div class="fragment"><div class="line">./build/bench_mc --benchmark_min_time=0.2s</div>
<div class="line"># BM_MC_1e6: ~0.10-0.12s (Debug)</div>
<div class="line"># BM_MC_1e6: ~0.05-0.08s (Release)</div>
</div><!-- fragment --><p><b>Scalability Analysis:</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Paths  </th><th class="markdownTableHeadNone">Time (s)  </th><th class="markdownTableHeadNone">Speedup  </th><th class="markdownTableHeadNone">Efficiency  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">100K  </td><td class="markdownTableBodyNone">0.01  </td><td class="markdownTableBodyNone">1.0Ã—  </td><td class="markdownTableBodyNone">100%  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1M  </td><td class="markdownTableBodyNone">0.10  </td><td class="markdownTableBodyNone">10.0Ã—  </td><td class="markdownTableBodyNone">100%  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">10M  </td><td class="markdownTableBodyNone">1.00  </td><td class="markdownTableBodyNone">100.0Ã—  </td><td class="markdownTableBodyNone">100%  </td></tr>
</table>
<p><b>Memory Usage:</b></p><ul>
<li><b>Streaming Architecture</b>: O(1) memory per path</li>
<li><b>No Path Storage</b>: Results computed on-the-fly</li>
<li><b>Cache Friendly</b>: Sequential memory access patterns</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md69"></a>
Comparison with Industry Standards</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Feature  </th><th class="markdownTableHeadNone">quant-pricer-cpp  </th><th class="markdownTableHeadNone">QuantLib  </th><th class="markdownTableHeadNone">Custom Solutions  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Speed</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Accuracy</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Greeks</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Testing</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Documentation</b>  </td><td class="markdownTableBodyNone">âš¡âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡âš¡  </td><td class="markdownTableBodyNone">âš¡  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md71"></a>
Testing &amp; CI</h1>
<p>The CI matrix covers linting, multi-platform Release builds, sanitizers, and a dedicated coverage job (Debug + gcovr + Codecov). FAST tests gate CI; SLOW tests run locally before publishing artifacts, and <span class="tt">./scripts/reproduce_all.sh</span> drops the verbose logs plus JUnit under <span class="tt">docs/artifacts/logs/slow_&lt;timestamp&gt;.{log,xml}</span> so regressions can be diffed later.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md72"></a>
Comprehensive Test Suite</h2>
<p><b>Unit Tests:</b> </p><div class="fragment"><div class="line"><span class="comment">// Blackâ€“Scholes validation</span></div>
<div class="line">TEST(BlackScholes, KnownValue_Call) { <span class="comment">/* Known reference values */</span> }</div>
<div class="line">TEST(BlackScholes, PutCallParity) { <span class="comment">/* Mathematical identity */</span> }</div>
<div class="line">TEST(BlackScholes, EdgeCases_ZeroT) { <span class="comment">/* Boundary conditions */</span> }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Monte Carlo validation</span></div>
<div class="line">TEST(MonteCarlo, PriceCloseToBS) { <span class="comment">/* Cross-method validation */</span> }</div>
<div class="line">TEST(MonteCarlo, VarianceReductionWorks) { <span class="comment">/* Antithetic + CV */</span> }</div>
<div class="line">TEST(MonteCarlo, GreeksCloseToAnalytic) { <span class="comment">/* Pathwise + LRM */</span> }</div>
<div class="line">TEST(MonteCarlo, QmcReducesErrorVsAnalytic) { <span class="comment">/* QMC superiority */</span> }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// PDE validation</span></div>
<div class="line">TEST(PDE, ConvergenceToBS) { <span class="comment">/* Grid refinement */</span> }</div>
<div class="line">TEST(PDE, BoundaryConditions) { <span class="comment">/* Dirichlet vs Neumann */</span> }</div>
</div><!-- fragment --><p><b>Integration Tests:</b></p><ul>
<li>Cross-method price agreement</li>
<li>Greek consistency across methods</li>
<li>Edge case handling</li>
<li>Numerical stability</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md73"></a>
CI/CD Pipeline</h2>
<p><b>Multi-Platform Testing:</b></p><ul>
<li><b>Operating Systems</b>: Ubuntu, macOS, Windows</li>
<li><b>Compilers</b>: GCC, Clang, MSVC</li>
<li><b>Build Types</b>: Release, Debug</li>
<li><b>Sanitizers</b>: AddressSanitizer, UBSanitizer</li>
<li><b>Static Analysis</b>: clang-tidy</li>
</ul>
<p>Wheels for Python bindings are built on tag pushes via cibuildwheel (Linux/macOS/Windows).</p>
<p><b>Code Quality:</b></p><ul>
<li><b>Formatting</b>: clang-format with LLVM style</li>
<li><b>Linting</b>: clang-tidy static analysis</li>
<li><b>Documentation</b>: Doxygen API generation</li>
<li><b>Pre-commit</b>: Automated quality checks</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md75"></a>
Docs</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md76"></a>
API Documentation</h2>
<p>Generated with Doxygen: </p><div class="fragment"><div class="line">doxygen Doxyfile</div>
<div class="line"># Output: docs/html/index.html</div>
</div><!-- fragment --><p><b>Mathematical Formulations:</b></p><ul>
<li>Blackâ€“Scholes equations with LaTeX rendering</li>
<li>Monte Carlo convergence proofs</li>
<li>PDE discretization schemes</li>
<li>Greek derivation formulas</li>
<li>Validation digest: docs/ValidationHighlights.md summarises the latest artifact bundle</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md77"></a>
Code Examples</h2>
<p><b>Basic Usage:</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="black__scholes_8hpp.html">quant/black_scholes.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="mc_8hpp.html">quant/mc.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="pde_8hpp.html">quant/pde.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Price European call</span></div>
<div class="line"><span class="keywordtype">double</span> S = 100.0, K = 100.0, r = 0.03, q = 0.0, sigma = 0.2, T = 1.0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Method 1: Blackâ€“Scholes</span></div>
<div class="line"><span class="keywordtype">double</span> bs_price = <a class="code hl_function" href="namespacequant_1_1bs.html#acc9f587fb3ed3d7184ffda96a3fa5f57">quant::bs::call_price</a>(S, K, r, q, sigma, T);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Method 2: Monte Carlo</span></div>
<div class="line"><a class="code hl_struct" href="structquant_1_1mc_1_1_mc_params.html">quant::mc::McParams</a> mc_params{S, K, r, q, sigma, T, 1000000, 42, <span class="keyword">true</span>, <span class="keyword">true</span>};</div>
<div class="line"><span class="keyword">auto</span> mc_result = <a class="code hl_function" href="namespacequant_1_1mc.html#a359142f9f448fda8bd468a8297093efc">quant::mc::price_european_call</a>(mc_params);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Method 3: PDE</span></div>
<div class="line"><a class="code hl_struct" href="structquant_1_1pde_1_1_pde_params.html">quant::pde::PdeParams</a> pde_params{S, K, r, q, sigma, T,</div>
<div class="line">                                 quant::pde::OptionType::Call, {201, 200, 4.0}, <span class="keyword">true</span>};</div>
<div class="line"><span class="keywordtype">double</span> pde_price = <a class="code hl_function" href="namespacequant_1_1pde.html#a04f166d2e994def76cd8ff8d4fc7fa0b">quant::pde::price_crank_nicolson</a>(pde_params);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cross-validation</span></div>
<div class="line">assert(std::abs(bs_price - mc_result.estimate.value) &lt; 3 * mc_result.estimate.std_error);</div>
<div class="line">assert(std::abs(bs_price - pde_price) &lt; 1e-6);</div>
<div class="ttc" id="ablack__scholes_8hpp_html"><div class="ttname"><a href="black__scholes_8hpp.html">black_scholes.hpp</a></div></div>
<div class="ttc" id="amc_8hpp_html"><div class="ttname"><a href="mc_8hpp.html">mc.hpp</a></div></div>
<div class="ttc" id="apde_8hpp_html"><div class="ttname"><a href="pde_8hpp.html">pde.hpp</a></div></div>
</div><!-- fragment --><p><b>Advanced Features:</b> </p><div class="fragment"><div class="line"><span class="comment">// Quasi-Monte Carlo with Greeks</span></div>
<div class="line">mc_params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a5c80140993b18711dcb84bdfd0360553">qmc</a> = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a6590300ef4c0f6f960ad4161d0ed706ca7010fe58c6d9b00dc52f088ed97cac75">quant::mc::McParams::Qmc::Sobol</a>;</div>
<div class="line">mc_params.<a class="code hl_variable" href="structquant_1_1mc_1_1_mc_params.html#a847477f8fc5bdda86e975f9e908e06b8">bridge</a> = <a class="code hl_enumvalue" href="structquant_1_1mc_1_1_mc_params.html#a411a107ecb4358d02633a2f8e2fb144da03e0195f94e8dc0663e0aeb5b5a859ae">quant::mc::McParams::Bridge::BrownianBridge</a>;</div>
<div class="line"><span class="keyword">auto</span> greeks = <a class="code hl_function" href="namespacequant_1_1mc.html#a5ed0f2a042a71e0a79981184cc74ce43">quant::mc::greeks_european_call</a>(mc_params);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// PDE with custom grid</span></div>
<div class="line">pde_params.<a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#adda4a423dfe3a8aa0ba650532b11d3b0">grid</a> = {401, 400, 6.0};  <span class="comment">// Higher resolution</span></div>
<div class="line">pde_params.<a class="code hl_variable" href="structquant_1_1pde_1_1_pde_params.html#af5b9f02c0d3103824e8aca43a62dfd81">upper_boundary</a> = <a class="code hl_enumvalue" href="structquant_1_1pde_1_1_pde_params.html#ae4220bab8d7f7a4e52c868d188d41f38ab8537a769dbc90cb1762215441212152">quant::pde::PdeParams::UpperBoundary::Neumann</a>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md78"></a>
WRDS (OptionMetrics) Pipeline</h2>
<p>Opt-in MARKET tests under <span class="tt">wrds_pipeline/</span> pull (or fall back to deterministic samples), aggregate the SPX surface, run a vega-weighted Heston calibration, and emit anonymised CSV/PNG bundles under <span class="tt">docs/artifacts/wrds/</span>. Set <span class="tt">WRDS_ENABLED=1</span> together with <span class="tt">WRDS_USERNAME</span> / <span class="tt">WRDS_PASSWORD</span> to enable <span class="tt">ctest -L MARKET</span>; otherwise the tests are skipped. Key artifacts (all aggregated / anonymised):</p>
<ul>
<li><a href="docs/artifacts/wrds/spx_2024-06-14_surface.csv"><span class="tt">docs/artifacts/wrds/spx_2024-06-14_surface.csv</span></a> and <a href="docs/artifacts/wrds/spx_2024-06-17_surface.csv"><span class="tt">docs/artifacts/wrds/spx_2024-06-17_surface.csv</span></a> â€“ tenor/moneyness buckets with mean IV/price/vega</li>
<li><a href="docs/artifacts/wrds/heston_fit_table.csv"><span class="tt">docs/artifacts/wrds/heston_fit_table.csv</span></a> + <a href="docs/artifacts/wrds/heston_fit.json"><span class="tt">docs/artifacts/wrds/heston_fit.json</span></a> â€“ calibrated parameters, bootstrap CIs, RMSE</li>
<li><a href="docs/artifacts/wrds/oos_pricing_detail.csv"><span class="tt">docs/artifacts/wrds/oos_pricing_detail.csv</span></a> + summary â€“ next-day IV/price diagnostics</li>
<li><a href="docs/artifacts/wrds/delta_hedge_pnl.csv"><span class="tt">docs/artifacts/wrds/delta_hedge_pnl.csv</span></a> + summary â€“ aggregated one-day delta-hedged PnL (ticks)</li>
<li><a href="docs/artifacts/wrds/heston_wrds_summary.png"><span class="tt">docs/artifacts/wrds/heston_wrds_summary.png</span></a> â€“ in-sample fit, OOS MAE, and PnL histogram</li>
</ul>
<p>Regenerate the public demo bundle with <span class="tt">./scripts/reproduce_all.sh</span> (uses the bundled sample data when WRDS env vars are absent) or run <span class="tt">python -m wrds_pipeline.pipeline --symbol SPX --trade-date 2024-06-14</span> after exporting <span class="tt">WRDS_ENABLED=1</span>, <span class="tt">WRDS_USERNAME</span>, and <span class="tt">WRDS_PASSWORD</span>. The CLI automatically maps the trade date to the correct OptionMetrics annual table (e.g., <span class="tt">optionm.opprcd2024</span>).</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md80"></a>
Limitations</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md81"></a>
Current Constraints</h2>
<ul>
<li><b>Term structures</b>: MC/PDE support piecewise-constant schedules (via CSV or programmatic <span class="tt">PiecewiseConstant</span>), but there is no curve-building or spline interpolation yet.</li>
<li><b>Multi-asset Greeks</b>: Basket and jump Monte Carlo engines expose prices only; pathwise/adjoint Greeks are on the roadmap.</li>
<li><b>Heston Monte Carlo</b>: The Andersen QE path engine is still experimentalâ€”treat the analytic solver as the reference implementation.</li>
<li><b>Dividends</b>: Only continuous dividend yields are modelled; discrete cash dividends are not.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md82"></a>
Known Limitations</h2>
<ul>
<li><b>PDE Greeks</b>: Implemented for CN grids (Î”, Î“ via three-point central around (S_0); optional Î˜ via one-step backward differencing). Accuracy depends on grid resolution and payoff smoothness; prefer MC Greeks near discontinuities (digitals/barriers) or when variance-reduction is available.</li>
<li><b>Memory Usage</b>: Large Monte Carlo simulations may require significant RAM.</li>
<li><b>Barrier MC</b>: The terminal-stock control variate is disabled by default to avoid bias; re-enable with <span class="tt">--cv</span> only if you can post-process the correction.</li>
<li><b>QMC Dimensionality</b>: Sobol sequences top out at 64 dimensions (Brownian bridge + hit uniforms â†’ â‰¤32 monitoring steps for barriers).</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md83"></a>
Performance Considerations</h2>
<ul>
<li><b>Monte Carlo</b>: Linear scaling with number of paths</li>
<li><b>PDE</b>: Quadratic scaling with grid resolution</li>
<li><b>Blackâ€“Scholes</b>: Constant time complexity</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md85"></a>
Roadmap</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md86"></a>
Near Term</h2>
<ul class="check">
<li class="unchecked"><b>Heston QE MC</b>: Bias correction, analytic control variate, and regression tests against the closed form.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Barrier MC</b>: Re-introduce unbiased control variates and document QMC/Brownian-bridge tuning.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Schedule ergonomics</b>: Curve loaders (flat/linear/exponential) and richer CLI validation.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md87"></a>
Medium Term</h2>
<ul class="check">
<li class="unchecked"><b>Multi-asset Greeks</b> (basket/jump diffusion) and variance-reduction hooks.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Discrete dividends</b> for analytics, MC, and PDE.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Calibration utilities</b> (Heston / local vol notebooks + report generation).</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md88"></a>
Long Term</h2>
<ul class="check">
<li class="unchecked"><b>GPU / multi-core acceleration</b> for high-path Monte Carlo workloads.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Scenario &amp; sensitivities</b>: portfolio risk toolkit beyond single-asset greeks.</li>
</ul>
<ul class="check">
<li class="unchecked"><b>Real-time integration</b>: streaming market data adapters and low-latency CLI mode.</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md90"></a>
License</h1>
<p><b>MIT License</b> - see [LICENSE](LICENSE) file for details.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md92"></a>
Contributing</h1>
<p>Contributions are welcome! Please see our contributing guidelines and code of conduct.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md93"></a>
Development Workflow</h2>
<ol type="1">
<li>Fork the repository</li>
<li>Create a feature branch</li>
<li>Add tests for new functionality</li>
<li>Ensure all tests pass and CI is green</li>
<li>Submit a pull request</li>
</ol>
<h2 class="doxsection"><a class="anchor" id="autotoc_md94"></a>
Code Standards</h2>
<ul>
<li><b>C++20</b>: Modern C++ features and best practices</li>
<li><b>Testing</b>: Comprehensive unit and integration tests</li>
<li><b>Documentation</b>: Doxygen comments for all public APIs</li>
<li><b>Performance</b>: Benchmarks for performance-critical code</li>
</ul>
<hr  />
<p><b>Built with â¤ï¸ for the quantitative finance community</b></p>
<p><em>For questions, issues, or contributions, please visit our <a href="https://github.com/mateobodon/quant-pricer-cpp">GitHub repository</a>.</em> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
